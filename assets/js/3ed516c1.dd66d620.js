"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[283],{669:(e,s,n)=>{n.d(s,{A:()=>i});const i=n.p+"assets/images/hue-wheel-c49e6582240e8af2ccba3fa0b5d56475.png"},760:(e,s,n)=>{n.d(s,{A:()=>i});const i=n.p+"assets/images/pwm_led-99e7e25dfc8515e2e21b4990787538d0.gif"},2942:(e,s,n)=>{n.d(s,{A:()=>i});const i=n.p+"assets/images/phase_correct_pwm-0813510f0ec626ea0e4a3968225159b6.png"},3205:(e,s,n)=>{n.d(s,{A:()=>r});n(6540);var i=n(7481),a=n(3092),l=n(4848);const r=e=>{let{left:s,right:n}=e;return(0,l.jsxs)("div",{style:{display:"flex",gap:"20px",alignItems:"flex-start"},children:[(0,l.jsxs)("div",{style:{flex:1},children:[(0,l.jsx)(i.o,{remarkPlugins:[a.A],children:s})," "]}),(0,l.jsxs)("div",{style:{flex:1},children:[(0,l.jsx)(i.o,{remarkPlugins:[a.A],children:n})," "]})]})}},5537:(e,s,n)=>{n.d(s,{A:()=>N});var i=n(6540),a=n(4164),l=n(5627),r=n(6347),t=n(372),c=n(604),d=n(1861),h=n(8749);function o(e){return i.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,i.isValidElement)(e)&&function(e){const{props:s}=e;return!!s&&"object"==typeof s&&"value"in s}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function m(e){const{values:s,children:n}=e;return(0,i.useMemo)((()=>{const e=s??function(e){return o(e).map((e=>{let{props:{value:s,label:n,attributes:i,default:a}}=e;return{value:s,label:n,attributes:i,default:a}}))}(n);return function(e){const s=(0,d.XI)(e,((e,s)=>e.value===s.value));if(s.length>0)throw new Error(`Docusaurus error: Duplicate values "${s.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[s,n])}function x(e){let{value:s,tabValues:n}=e;return n.some((e=>e.value===s))}function j(e){let{queryString:s=!1,groupId:n}=e;const a=(0,r.W6)(),l=function(e){let{queryString:s=!1,groupId:n}=e;if("string"==typeof s)return s;if(!1===s)return null;if(!0===s&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:s,groupId:n});return[(0,c.aZ)(l),(0,i.useCallback)((e=>{if(!l)return;const s=new URLSearchParams(a.location.search);s.set(l,e),a.replace({...a.location,search:s.toString()})}),[l,a])]}function p(e){const{defaultValue:s,queryString:n=!1,groupId:a}=e,l=m(e),[r,c]=(0,i.useState)((()=>function(e){let{defaultValue:s,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(s){if(!x({value:s,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${s}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return s}const i=n.find((e=>e.default))??n[0];if(!i)throw new Error("Unexpected error: 0 tabValues");return i.value}({defaultValue:s,tabValues:l}))),[d,o]=j({queryString:n,groupId:a}),[p,u]=function(e){let{groupId:s}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(s),[a,l]=(0,h.Dv)(n);return[a,(0,i.useCallback)((e=>{n&&l.set(e)}),[n,l])]}({groupId:a}),g=(()=>{const e=d??p;return x({value:e,tabValues:l})?e:null})();(0,t.A)((()=>{g&&c(g)}),[g]);return{selectedValue:r,selectValue:(0,i.useCallback)((e=>{if(!x({value:e,tabValues:l}))throw new Error(`Can't select invalid tab value=${e}`);c(e),o(e),u(e)}),[o,u,l]),tabValues:l}}var u=n(9136);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var f=n(4848);function b(e){let{className:s,block:n,selectedValue:i,selectValue:r,tabValues:t}=e;const c=[],{blockElementScrollPositionUntilNextRender:d}=(0,l.a_)(),h=e=>{const s=e.currentTarget,n=c.indexOf(s),a=t[n].value;a!==i&&(d(s),r(a))},o=e=>{let s=null;switch(e.key){case"Enter":h(e);break;case"ArrowRight":{const n=c.indexOf(e.currentTarget)+1;s=c[n]??c[0];break}case"ArrowLeft":{const n=c.indexOf(e.currentTarget)-1;s=c[n]??c[c.length-1];break}}s?.focus()};return(0,f.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.A)("tabs",{"tabs--block":n},s),children:t.map((e=>{let{value:s,label:n,attributes:l}=e;return(0,f.jsx)("li",{role:"tab",tabIndex:i===s?0:-1,"aria-selected":i===s,ref:e=>{c.push(e)},onKeyDown:o,onClick:h,...l,className:(0,a.A)("tabs__item",g.tabItem,l?.className,{"tabs__item--active":i===s}),children:n??s},s)}))})}function v(e){let{lazy:s,children:n,selectedValue:l}=e;const r=(Array.isArray(n)?n:[n]).filter(Boolean);if(s){const e=r.find((e=>e.props.value===l));return e?(0,i.cloneElement)(e,{className:(0,a.A)("margin-top--md",e.props.className)}):null}return(0,f.jsx)("div",{className:"margin-top--md",children:r.map(((e,s)=>(0,i.cloneElement)(e,{key:s,hidden:e.props.value!==l})))})}function y(e){const s=p(e);return(0,f.jsxs)("div",{className:(0,a.A)("tabs-container",g.tabList),children:[(0,f.jsx)(b,{...s,...e}),(0,f.jsx)(v,{...s,...e})]})}function N(e){const s=(0,u.A)();return(0,f.jsx)(y,{...e,children:o(e.children)},String(s))}},5640:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>t,default:()=>o,frontMatter:()=>r,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"lab03/index","title":"Lab 3: Timers, Pulse Width Modulation (PWM)","description":"Helpful chapters from the ATmega324P Datasheet","source":"@site/lab/lab03/index.mdx","sourceDirName":"lab03","slug":"/lab03/","permalink":"/lab/lab03/","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"labSidebar","previous":{"title":"Laboratory 2: Interrupts, Timers","permalink":"/lab/lab02/"},"next":{"title":"Lab 4: Analog to Digital Converter (ADC)","permalink":"/lab/lab04/"}}');var a=n(4848),l=n(8453);n(3205),n(7003),n(7272),n(5537),n(9329);const r={sidebar_position:5},t="Lab 3: Timers, Pulse Width Modulation (PWM)",c={},d=[{value:"1. Pulse Width Modulation",id:"1-pulse-width-modulation",level:2},{value:"1.1. Operating Principle",id:"11-operating-principle",level:3},{value:"2. PWM on AVR Microcontrollers",id:"2-pwm-on-avr-microcontrollers",level:2},{value:"Fast PWM",id:"fast-pwm",level:3},{value:"Example: Timer1 in Fast PWM 8-bit, non-inverting mode with 1024 prescaler",id:"example-timer1-in-fast-pwm-8-bit-non-inverting-mode-with-1024-prescaler",level:4},{value:"Phase Correct PWM",id:"phase-correct-pwm",level:3},{value:"Comparison: Fast PWM vs Phase Correct PWM",id:"comparison-fast-pwm-vs-phase-correct-pwm",level:3},{value:"3. Exercises",id:"3-exercises",level:2},{value:"Task 0",id:"task-0",level:3},{value:"Task 1",id:"task-1",level:3},{value:"Task 2",id:"task-2",level:3},{value:"Task 3",id:"task-3",level:3},{value:"Task 4 (Bonus)",id:"task-4-bonus",level:3},{value:"Bonus 2",id:"bonus-2",level:3},{value:"4. Useful Links",id:"4-useful-links",level:2}];function h(e){const s={a:"a",admonition:"admonition",annotation:"annotation",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",img:"img",li:"li",math:"math",mfrac:"mfrac",mi:"mi",mn:"mn",mo:"mo",mover:"mover",mrow:"mrow",msub:"msub",ol:"ol",p:"p",pre:"pre",semantics:"semantics",span:"span",strong:"strong",ul:"ul",...(0,l.R)(),...e.components},{Details:i}=s;return i||function(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.header,{children:(0,a.jsx)(s.h1,{id:"lab-3-timers-pulse-width-modulation-pwm",children:"Lab 3: Timers, Pulse Width Modulation (PWM)"})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsxs)(s.strong,{children:["Helpful chapters from the ",(0,a.jsx)(s.a,{href:"https://ww1.microchip.com/downloads/en/DeviceDoc/Atmel-42743-ATmega324P_Datasheet.pdf",children:"ATmega324P Datasheet"})]})}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["\n",(0,a.jsxs)(s.ol,{children:["\n",(0,a.jsx)(s.li,{children:"Pin Configurations \u2013 section 1.1, page 15"}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(s.li,{children:["\n",(0,a.jsxs)(s.ol,{start:"16",children:["\n",(0,a.jsx)(s.li,{children:"8-bit Timer/Counter0 with PWM \u2013 section 16.9, page 140"}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(s.li,{children:["\n",(0,a.jsxs)(s.ol,{start:"17",children:["\n",(0,a.jsx)(s.li,{children:"16-bit Timer/Counter1 with PWM \u2013 section 17.14, page 173"}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(s.li,{children:["\n",(0,a.jsxs)(s.ol,{start:"19",children:["\n",(0,a.jsx)(s.li,{children:"8-bit Timer/Counter2 with PWM and asynchronous operation \u2013 section 19.11, page 202"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h2,{id:"1-pulse-width-modulation",children:"1. Pulse Width Modulation"}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"PWM"})," (Pulse Width Modulation) is a technique used to control the voltage applied to an electronic device by quickly switching it between ON and OFF states."]}),"\n",(0,a.jsxs)(s.p,{children:["This rapid switching results in an average voltage determined by the time the signal stays ON versus the total cycle time \u2014 this ratio is called the ",(0,a.jsx)(s.strong,{children:"duty cycle"}),"."]}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{alt:"PWM Principle",src:n(8325).A+"",width:"561",height:"210"})}),"\n",(0,a.jsxs)(s.p,{children:["PWM allows ",(0,a.jsx)(s.strong,{children:"digital control"})," over ",(0,a.jsx)(s.strong,{children:"analog signals"})," \u2014 for instance:"]}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"Dimming an LED"}),"\n",(0,a.jsx)(s.li,{children:"Changing the color of RGB LEDs"}),"\n",(0,a.jsx)(s.li,{children:"Setting the pitch of a buzzer"}),"\n",(0,a.jsx)(s.li,{children:"Adjusting the speed of a motor"}),"\n"]}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{alt:"PWM LED Control",src:n(760).A+"",width:"1200",height:"600"})}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h3,{id:"11-operating-principle",children:"1.1. Operating Principle"}),"\n",(0,a.jsx)(s.p,{children:"The duty cycle is expressed as a percentage of the ON time relative to the total cycle:"}),"\n",(0,a.jsx)(s.span,{className:"katex-display",children:(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mi,{children:"D"}),(0,a.jsx)(s.mo,{stretchy:"false",children:"["}),(0,a.jsx)(s.mi,{mathvariant:"normal",children:"%"}),(0,a.jsx)(s.mo,{stretchy:"false",children:"]"}),(0,a.jsx)(s.mo,{children:"="}),(0,a.jsxs)(s.mfrac,{children:[(0,a.jsxs)(s.msub,{children:[(0,a.jsx)(s.mi,{children:"t"}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mi,{children:"o"}),(0,a.jsx)(s.mi,{children:"n"})]})]}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsxs)(s.msub,{children:[(0,a.jsx)(s.mi,{children:"t"}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mi,{children:"o"}),(0,a.jsx)(s.mi,{children:"n"})]})]}),(0,a.jsx)(s.mo,{children:"+"}),(0,a.jsxs)(s.msub,{children:[(0,a.jsx)(s.mi,{children:"t"}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mi,{children:"o"}),(0,a.jsx)(s.mi,{children:"f"}),(0,a.jsx)(s.mi,{children:"f"})]})]})]})]}),(0,a.jsx)(s.mo,{children:"\u22c5"}),(0,a.jsx)(s.mn,{children:"100"}),(0,a.jsx)(s.mo,{children:"="}),(0,a.jsxs)(s.mfrac,{children:[(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mi,{children:"p"}),(0,a.jsx)(s.mi,{children:"u"}),(0,a.jsx)(s.mi,{children:"l"}),(0,a.jsx)(s.mi,{children:"s"}),(0,a.jsx)(s.mi,{children:"e"}),(0,a.jsx)(s.mi,{mathvariant:"normal",children:"_"}),(0,a.jsx)(s.mi,{children:"w"}),(0,a.jsx)(s.mi,{children:"i"}),(0,a.jsx)(s.mi,{children:"d"}),(0,a.jsx)(s.mi,{children:"t"}),(0,a.jsx)(s.mi,{children:"h"})]}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mi,{children:"p"}),(0,a.jsx)(s.mi,{children:"e"}),(0,a.jsx)(s.mi,{children:"r"}),(0,a.jsx)(s.mi,{children:"i"}),(0,a.jsx)(s.mi,{children:"o"}),(0,a.jsx)(s.mi,{children:"d"})]})]}),(0,a.jsx)(s.mo,{children:"\u22c5"}),(0,a.jsx)(s.mn,{children:"100"})]}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"D[\\%] = \\frac{t_{on}}{t_{on} + t_{off}} \\cdot 100 = \\frac{pulse\\_width}{period} \\cdot 100"})]})})}),(0,a.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"D"}),(0,a.jsx)(s.span,{className:"mopen",children:"["}),(0,a.jsx)(s.span,{className:"mord",children:"%"}),(0,a.jsx)(s.span,{className:"mclose",children:"]"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,a.jsx)(s.span,{className:"mrel",children:"="}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"2.2642em",verticalAlign:"-0.9721em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mopen nulldelimiter"}),(0,a.jsx)(s.span,{className:"mfrac",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsxs)(s.span,{className:"vlist",style:{height:"1.2921em"},children:[(0,a.jsxs)(s.span,{style:{top:"-2.314em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord mathnormal",children:"t"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.1514em"},children:(0,a.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsxs)(s.span,{className:"mord mtight",children:[(0,a.jsx)(s.span,{className:"mord mathnormal mtight",children:"o"}),(0,a.jsx)(s.span,{className:"mord mathnormal mtight",children:"n"})]})})]})}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(s.span,{})})})]})})]}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,a.jsx)(s.span,{className:"mbin",children:"+"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord mathnormal",children:"t"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.3361em"},children:(0,a.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsxs)(s.span,{className:"mord mtight",children:[(0,a.jsx)(s.span,{className:"mord mathnormal mtight",children:"o"}),(0,a.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.10764em"},children:"ff"})]})})]})}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.2861em"},children:(0,a.jsx)(s.span,{})})})]})})]})]})]}),(0,a.jsxs)(s.span,{style:{top:"-3.23em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,a.jsxs)(s.span,{style:{top:"-3.677em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"mord",children:(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord mathnormal",children:"t"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.1514em"},children:(0,a.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsxs)(s.span,{className:"mord mtight",children:[(0,a.jsx)(s.span,{className:"mord mathnormal mtight",children:"o"}),(0,a.jsx)(s.span,{className:"mord mathnormal mtight",children:"n"})]})})]})}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(s.span,{})})})]})})]})})]})]}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.9721em"},children:(0,a.jsx)(s.span,{})})})]})}),(0,a.jsx)(s.span,{className:"mclose nulldelimiter"})]}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,a.jsx)(s.span,{className:"mbin",children:"\u22c5"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.6444em"}}),(0,a.jsx)(s.span,{className:"mord",children:"100"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,a.jsx)(s.span,{className:"mrel",children:"="}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"2.2749em",verticalAlign:"-0.8804em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mopen nulldelimiter"}),(0,a.jsx)(s.span,{className:"mfrac",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsxs)(s.span,{className:"vlist",style:{height:"1.3944em"},children:[(0,a.jsxs)(s.span,{style:{top:"-2.314em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord mathnormal",children:"p"}),(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"er"}),(0,a.jsx)(s.span,{className:"mord mathnormal",children:"i"}),(0,a.jsx)(s.span,{className:"mord mathnormal",children:"o"}),(0,a.jsx)(s.span,{className:"mord mathnormal",children:"d"})]})]}),(0,a.jsxs)(s.span,{style:{top:"-3.23em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,a.jsxs)(s.span,{style:{top:"-3.7em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord mathnormal",children:"p"}),(0,a.jsx)(s.span,{className:"mord mathnormal",children:"u"}),(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.01968em"},children:"l"}),(0,a.jsx)(s.span,{className:"mord mathnormal",children:"se"}),(0,a.jsx)(s.span,{className:"mord",style:{marginRight:"0.02778em"},children:"_"}),(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.02691em"},children:"w"}),(0,a.jsx)(s.span,{className:"mord mathnormal",children:"i"}),(0,a.jsx)(s.span,{className:"mord mathnormal",children:"d"}),(0,a.jsx)(s.span,{className:"mord mathnormal",children:"t"}),(0,a.jsx)(s.span,{className:"mord mathnormal",children:"h"})]})]})]}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.8804em"},children:(0,a.jsx)(s.span,{})})})]})}),(0,a.jsx)(s.span,{className:"mclose nulldelimiter"})]}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,a.jsx)(s.span,{className:"mbin",children:"\u22c5"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.6444em"}}),(0,a.jsx)(s.span,{className:"mord",children:"100"})]})]})]})}),"\n",(0,a.jsxs)(s.p,{children:["The ",(0,a.jsx)(s.strong,{children:"average voltage"})," received by a device is:"]}),"\n",(0,a.jsx)(s.span,{className:"katex-display",children:(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsxs)(s.mrow,{children:[(0,a.jsxs)(s.mover,{accent:"true",children:[(0,a.jsx)(s.mi,{children:"V"}),(0,a.jsx)(s.mo,{children:"\u02c9"})]}),(0,a.jsx)(s.mo,{children:"="}),(0,a.jsx)(s.mi,{children:"D"}),(0,a.jsx)(s.mo,{children:"\u22c5"}),(0,a.jsxs)(s.msub,{children:[(0,a.jsx)(s.mi,{children:"V"}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mi,{children:"c"}),(0,a.jsx)(s.mi,{children:"c"})]})]})]}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\bar{V} = D \\cdot V_{cc}"})]})})}),(0,a.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.8201em"}}),(0,a.jsx)(s.span,{className:"mord accent",children:(0,a.jsx)(s.span,{className:"vlist-t",children:(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsxs)(s.span,{className:"vlist",style:{height:"0.8201em"},children:[(0,a.jsxs)(s.span,{style:{top:"-3em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.22222em"},children:"V"})]}),(0,a.jsxs)(s.span,{style:{top:"-3.2523em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"accent-body",style:{left:"-0.25em"},children:(0,a.jsx)(s.span,{className:"mord",children:"\u02c9"})})]})]})})})}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,a.jsx)(s.span,{className:"mrel",children:"="}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.6833em"}}),(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"D"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,a.jsx)(s.span,{className:"mbin",children:"\u22c5"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.22222em"},children:"V"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.1514em"},children:(0,a.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.2222em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:(0,a.jsx)(s.span,{className:"mord mathnormal mtight",children:"cc"})})})]})}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(s.span,{})})})]})})]})]})]})]})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{alt:"PWM waveforms with different duty cycles",src:n(7969).A+"",width:"987",height:"237"})}),"\n",(0,a.jsxs)(s.p,{children:["PWM signals are typically generated by digital circuits and microcontrollers. The ATmega324 uses a ",(0,a.jsx)(s.strong,{children:"counter"})," that resets periodically and compares its value with a reference (",(0,a.jsx)(s.code,{children:"OCRn"}),"). When the counter exceeds the reference value, the PWM output toggles its state."]}),"\n",(0,a.jsxs)(i,{children:[(0,a.jsx)("summary",{children:"\ud83d\udee0\ufe0f PWM via software?"}),(0,a.jsx)(s.p,{children:"PWM can also be implemented in software using methods like:"}),(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"Bit-banging"}),"\n",(0,a.jsx)(s.li,{children:"Timers with ISR"}),"\n"]}),(0,a.jsx)(s.p,{children:"But for high-frequency PWM (e.g., kHz range for motors), hardware PWM is far more efficient, avoiding CPU overhead from frequent interrupts."})]}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h2,{id:"2-pwm-on-avr-microcontrollers",children:"2. PWM on AVR Microcontrollers"}),"\n",(0,a.jsx)(s.p,{children:"In the previous lab, we saw that the ATmega324 has three timers:"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"Timer0"})," (8-bit)"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"Timer1"})," (16-bit)"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"Timer2"})," (8-bit)"]}),"\n"]}),"\n",(0,a.jsxs)(s.p,{children:["Each timer can be configured via the control registers ",(0,a.jsx)(s.code,{children:"TCCRnA"})," and ",(0,a.jsx)(s.code,{children:"TCCRnB"}),", using the ",(0,a.jsx)(s.code,{children:"WGMnx"})," bits to select the mode:"]}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.strong,{children:"Normal"})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.strong,{children:"CTC (Clear Timer on Compare Match)"})}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Fast PWM"})," (used today!)"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Phase Correct PWM"}),", etc."]}),"\n"]}),"\n",(0,a.jsxs)(s.p,{children:["Each timer has two output compare channels: ",(0,a.jsx)(s.code,{children:"OCnA"})," and ",(0,a.jsx)(s.code,{children:"OCnB"}),". These are tied to specific physical pins. Check the ",(0,a.jsx)(s.strong,{children:"Pin Configurations"})," chapter of the datasheet for exact mappings:"]}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{alt:"PWM Output Pins on ATmega324P",src:n(5743).A+"",width:"799",height:"643"})}),"\n",(0,a.jsxs)(s.p,{children:["Today we\u2019ll focus on ",(0,a.jsx)(s.strong,{children:"Fast PWM"}),", a common mode suitable for general applications like LED dimming and motor speed control."]}),"\n",(0,a.jsx)(s.h3,{id:"fast-pwm",children:"Fast PWM"}),"\n",(0,a.jsxs)(s.p,{children:["In ",(0,a.jsx)(s.strong,{children:"Fast PWM"})," mode, the timer counts only on the ",(0,a.jsx)(s.strong,{children:"rising edge"})," of the clock signal. The duty cycle changes take effect immediately, but the waveform is not centered \u2014 a shift or glitch may appear when changing the duty cycle significantly."]}),"\n",(0,a.jsxs)(s.p,{children:["Several Fast PWM modes are available for different timers. For ",(0,a.jsx)(s.strong,{children:"Timer1"}),", you have:"]}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"Fast PWM, 8-bit: TOP = 0x00FF"}),"\n",(0,a.jsx)(s.li,{children:"Fast PWM, 9-bit: TOP = 0x01FF"}),"\n",(0,a.jsx)(s.li,{children:"Fast PWM, 10-bit: TOP = 0x03FF"}),"\n",(0,a.jsxs)(s.li,{children:["Fast PWM with TOP in ",(0,a.jsx)(s.code,{children:"ICR"})]}),"\n",(0,a.jsxs)(s.li,{children:["Fast PWM with TOP in ",(0,a.jsx)(s.code,{children:"OCRnA"})]}),"\n"]}),"\n",(0,a.jsx)(s.admonition,{title:"\ud83d\udca1",type:"note",children:(0,a.jsxs)(s.p,{children:["In this lab, we\u2019ll use only ",(0,a.jsx)(s.strong,{children:"Fast PWM 8-bit mode"}),". Refer to the datasheet for other timer-specific modes and features."]})}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsxs)(s.p,{children:["Suppose Timer1 is configured in ",(0,a.jsx)(s.strong,{children:"Fast PWM"})," mode. This mode has a fixed frequency and allows the duty cycle (threshold) to be modified during execution."]}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["With mode ",(0,a.jsx)(s.code,{children:"10"})," for ",(0,a.jsx)(s.code,{children:"COM1A1:COM1A0"}),", the signal on pin ",(0,a.jsx)(s.code,{children:"OC1A"})," stays HIGH during counting up to the threshold, and LOW afterwards until the end of the cycle."]}),"\n",(0,a.jsxs)(s.li,{children:["To get a duty cycle of ",(0,a.jsx)(s.code,{children:"x%"}),", set:",(0,a.jsx)(s.br,{}),"\n",(0,a.jsx)(s.code,{children:"OCR1A = x * TOP / 100"}),(0,a.jsx)(s.br,{}),"\n","where ",(0,a.jsx)(s.code,{children:"TOP"})," is 255 (8-bit), 511 (9-bit), or 1023 (10-bit), depending on configuration."]}),"\n"]}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h4,{id:"example-timer1-in-fast-pwm-8-bit-non-inverting-mode-with-1024-prescaler",children:"Example: Timer1 in Fast PWM 8-bit, non-inverting mode with 1024 prescaler"}),"\n",(0,a.jsxs)(s.p,{children:["PWM frequency \u2248 12 MHz / 1024 / 255 \u2248 ",(0,a.jsx)(s.strong,{children:"45 Hz"})]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-c",children:"/* OC1A is PD5, must be configured as OUTPUT */\nDDRB |= (1 << PD5);\n\n/* Select Fast PWM 8-bit mode: WGM[3:0] = 0b0101 */\n/* WGM10 and WGM11 -> TCCR1A; WGM12 and WGM13 -> TCCR1B */\nTCCR1A = (1 << WGM10);\nTCCR1B = (1 << WGM12);\n\n/* Set non-inverting mode on OC1A: COM1A[1:0] = 0b10 */\nTCCR1A |= (1 << COM1A1);\n\n/* Set prescaler to 1024: CS1[2:0] = 0b101 */\nTCCR1B |= (1 << CS12) | (1 << CS10);\n\n/* Set 50% duty cycle (TOP = 255, so OCR1A = 127) */\nOCR1A = 127;\n"})}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h3,{id:"phase-correct-pwm",children:"Phase Correct PWM"}),"\n",(0,a.jsxs)(s.p,{children:["Although we won\u2019t use this in the lab, it\u2019s useful to understand how ",(0,a.jsx)(s.strong,{children:"Phase Correct PWM"})," differs from Fast PWM \u2014 it offers better accuracy, often required for ",(0,a.jsx)(s.strong,{children:"BLDC motors or audio"}),"."]}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Key difference"}),": the counter counts up from BOTTOM to TOP, then back down to BOTTOM."]}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["Output is set based on comparison with ",(0,a.jsx)(s.code,{children:"OCRnx"}),", just like Fast PWM."]}),"\n",(0,a.jsxs)(s.li,{children:["However, ",(0,a.jsx)(s.code,{children:"OCRnx"})," remains constant during the full cycle, resulting in stable ON durations and ",(0,a.jsx)(s.strong,{children:"cleaner"})," signals."]}),"\n",(0,a.jsx)(s.li,{children:"This avoids frequency shifts (jitter) \u2014 important for motors, which can lose efficiency due to inconsistent PWM."}),"\n"]}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{alt:"Phase Correct PWM Timing",src:n(2942).A+"",width:"943",height:"520"})}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h3,{id:"comparison-fast-pwm-vs-phase-correct-pwm",children:"Comparison: Fast PWM vs Phase Correct PWM"}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{alt:"Fast PWM (left) vs Phase Correct PWM (right)",src:n(9646).A+"",width:"2074",height:"1000"})}),"\n",(0,a.jsx)(s.h2,{id:"3-exercises",children:"3. Exercises"}),"\n",(0,a.jsx)(s.p,{children:"The goal of these exercises is to control the color of an RGB LED using PWM. You can produce any color by adjusting the brightness of each diode (Red, Green, Blue) independently!"}),"\n",(0,a.jsx)(s.p,{children:"The RGB LED pins are connected as follows:"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Red"}),": pin ",(0,a.jsx)(s.code,{children:"PD5"}),", function ",(0,a.jsx)(s.code,{children:"OC1A"})," (linked to Timer1)"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Green"}),": pin ",(0,a.jsx)(s.code,{children:"PD7"}),", function ",(0,a.jsx)(s.code,{children:"OC2A"})," (linked to Timer2)"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Blue"}),": pin ",(0,a.jsx)(s.code,{children:"PB3"}),", function ",(0,a.jsx)(s.code,{children:"OC0A"})," (linked to Timer0)"]}),"\n"]}),"\n",(0,a.jsx)(s.admonition,{title:"Reminder",type:"info",children:(0,a.jsxs)(s.p,{children:["The RGB LED is wired with ",(0,a.jsx)(s.strong,{children:"common anode"}),' / "active-low" configuration \u2014 the LED turns ON when the pin is set to LOW, and OFF when set to HIGH.']})}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h3,{id:"task-0",children:"Task 0"}),"\n",(0,a.jsxs)(s.ol,{children:["\n",(0,a.jsxs)(s.li,{children:["Download and run the ",(0,a.jsx)(s.a,{href:"https://ocw.cs.pub.ro/courses/_media/pm/lab/lab3-2023-2024/lab3-skel-2023-2024.zip",children:"starter project ZIP"}),".","\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"What do you observe on the board?"}),"\n",(0,a.jsx)(s.li,{children:"Check the serial monitor \u2014 do you remember how timing was handled in the previous lab?"}),"\n",(0,a.jsx)(s.li,{children:"How does the LED behave? Which timer is used and in what mode?"}),"\n",(0,a.jsx)(s.li,{children:"Where is the intensity updated? What input does the formula use, and where is the output applied?"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h3,{id:"task-1",children:"Task 1"}),"\n",(0,a.jsxs)(s.ol,{children:["\n",(0,a.jsxs)(s.li,{children:["Let\u2019s make the ",(0,a.jsx)(s.strong,{children:"blue"})," LED behave similarly.","\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["Use Timer0 (",(0,a.jsx)(s.code,{children:"OC0A"})," on ",(0,a.jsx)(s.code,{children:"PB3"}),") in ",(0,a.jsx)(s.strong,{children:"Fast PWM"})," mode."]}),"\n",(0,a.jsxs)(s.li,{children:["Be sure to check ",(0,a.jsx)(s.strong,{children:"Section 12.9"})," in the ",(0,a.jsx)(s.a,{href:"https://ww1.microchip.com/downloads/en/DeviceDoc/Atmel-42743-ATmega324P_Datasheet.pdf",children:"ATmega324P Datasheet"})," for proper register usage \u2014 Timer0's registers differ from Timer1's!"]}),"\n",(0,a.jsxs)(s.li,{children:["Make the blue LED ",(0,a.jsx)(s.strong,{children:"pulse faster"})," than red, and in ",(0,a.jsx)(s.strong,{children:"parallel"}),"."]}),"\n",(0,a.jsx)(s.li,{children:"What do you notice?"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h3,{id:"task-2",children:"Task 2"}),"\n",(0,a.jsxs)(s.ol,{children:["\n",(0,a.jsxs)(s.li,{children:["Time to turn on the ",(0,a.jsx)(s.strong,{children:"green"})," LED!","\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["Challenge: ",(0,a.jsx)(s.code,{children:"PD7"})," (OC2A) is used by Timer2, which is already used for ",(0,a.jsx)(s.code,{children:"millis()"})," system ticks..."]}),"\n",(0,a.jsxs)(s.li,{children:["Solution: We\u2019ll generate PWM manually using ",(0,a.jsx)(s.strong,{children:"interrupts"}),":","\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["Timer2 counts from 0 to 188 and triggers an interrupt via ",(0,a.jsx)(s.code,{children:"COMPA"})," (to increment ",(0,a.jsx)(s.code,{children:"systicks"}),")."]}),"\n",(0,a.jsxs)(s.li,{children:["Timer2\u2019s second comparator ",(0,a.jsx)(s.code,{children:"COMPB"})," triggers an interrupt at a value between 0\u2013188."]}),"\n",(0,a.jsxs)(s.li,{children:["In ",(0,a.jsx)(s.code,{children:"COMPA ISR"}),": turn ON green LED \u2192 set GPIO LOW."]}),"\n",(0,a.jsxs)(s.li,{children:["In ",(0,a.jsx)(s.code,{children:"COMPB ISR"}),": turn OFF green LED \u2192 set GPIO HIGH."]}),"\n",(0,a.jsxs)(s.li,{children:["Duty cycle is given by ",(0,a.jsx)(s.code,{children:"OCR2B"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(s.admonition,{type:"warning",children:(0,a.jsxs)(s.p,{children:["Keep ",(0,a.jsx)(s.code,{children:"OCR2A = 188"})," to retain proper ",(0,a.jsx)(s.code,{children:"millis()"})," timing."]})}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h3,{id:"task-3",children:"Task 3"}),"\n",(0,a.jsxs)(s.ol,{children:["\n",(0,a.jsxs)(s.li,{children:["Cycle through all colors using ",(0,a.jsx)(s.strong,{children:"HSV color space"}),":","\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["Convert HSV \u2192 RGB using provided ",(0,a.jsx)(s.code,{children:"convert_HSV_to_RGB()"})," function."]}),"\n",(0,a.jsxs)(s.li,{children:["Let ",(0,a.jsx)(s.code,{children:"Hue"})," animate over time, keep ",(0,a.jsx)(s.code,{children:"Saturation = 1"}),", ",(0,a.jsx)(s.code,{children:"Value = 1"})," (for full brightness)."]}),"\n",(0,a.jsx)(s.li,{children:"Use system ticks to animate the color smoothly, just like LED pulsing."}),"\n",(0,a.jsx)(s.li,{children:"Make sure to disable any conflicting code that modifies LED intensity."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{alt:"HSV Color Wheel",src:n(669).A+"",width:"650",height:"555"})}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h3,{id:"task-4-bonus",children:"Task 4 (Bonus)"}),"\n",(0,a.jsxs)(s.ol,{children:["\n",(0,a.jsxs)(s.li,{children:["Use the ",(0,a.jsx)(s.strong,{children:"speaker"})," connected to ",(0,a.jsx)(s.code,{children:"PD4"})," (also ",(0,a.jsx)(s.code,{children:"OC1B"}),") to ",(0,a.jsx)(s.strong,{children:"play a melody"})," from the ",(0,a.jsx)(s.code,{children:"sound.c"})," module.","\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"surprise_notes[]"})," contains frequencies."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"durations[]"})," stores note durations."]}),"\n",(0,a.jsxs)(s.li,{children:["In ",(0,a.jsx)(s.code,{children:"update_notes()"}),", reconfigure Timer1 each time a new note is played.","\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["Use ",(0,a.jsx)(s.strong,{children:"CTC mode"})," (",(0,a.jsx)(s.code,{children:"OCR1A"})," sets the TOP \u2192 controls frequency)."]}),"\n",(0,a.jsxs)(s.li,{children:["Set ",(0,a.jsx)(s.code,{children:"OCR1B = OCR1A / 2"})," for 50% duty cycle (square wave)."]}),"\n",(0,a.jsxs)(s.li,{children:["Call ",(0,a.jsx)(s.code,{children:"update_notes()"})," every ",(0,a.jsx)(s.strong,{children:"25ms"})," using ",(0,a.jsx)(s.code,{children:"systicks"}),"."]}),"\n",(0,a.jsxs)(s.li,{children:["Reset ",(0,a.jsx)(s.code,{children:"TCNT1 = 0"})," after changing ",(0,a.jsx)(s.code,{children:"OCR1A"})," to avoid timing delays."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h3,{id:"bonus-2",children:"Bonus 2"}),"\n",(0,a.jsx)(s.p,{children:"Combine:"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["RGB animation (HSV cycling) ",(0,a.jsx)(s.strong,{children:"and"})]}),"\n",(0,a.jsx)(s.li,{children:"Sound playback (melody via speaker)"}),"\n"]}),"\n",(0,a.jsxs)(s.p,{children:["\u2014 both running ",(0,a.jsx)(s.strong,{children:"simultaneously"})," and smoothly."]}),"\n",(0,a.jsx)(s.h2,{id:"4-useful-links",children:"4. Useful Links"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["[1] ",(0,a.jsx)(s.a,{href:"http://www.afrotechmods.com/groovy/PWM_tutorial/PWM_tutorial.htm",children:"PWM Video Tutorial"})]}),"\n",(0,a.jsxs)(s.li,{children:["[2] ",(0,a.jsx)(s.a,{href:"http://www.avrfreaks.net/index.php?name=PNphpBB2&file=printview&t=68302",children:"AVR Freaks PWM Guide"})]}),"\n",(0,a.jsxs)(s.li,{children:["[3] ",(0,a.jsx)(s.a,{href:"https://docs.arduino.cc/tutorials/generic/secrets-of-arduino-pwm",children:"Arduino PWM Secrets"})]}),"\n",(0,a.jsxs)(s.li,{children:["[4] ",(0,a.jsx)(s.a,{href:"https://ww1.microchip.com/downloads/en/DeviceDoc/Atmel-42743-ATmega324P_Datasheet.pdf",children:"ATmega324P Datasheet"})]}),"\n"]})]})}function o(e={}){const{wrapper:s}={...(0,l.R)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}},5743:(e,s,n)=>{n.d(s,{A:()=>i});const i=n.p+"assets/images/atmega324_pwm_pins-dd3744f2406886328e68cc7fe0b62027.png"},7003:(e,s,n)=>{n.d(s,{A:()=>l});n(6540);var i=n(8069),a=n(4848);const l=e=>{let{code:s,language:n="javascript",inline:l=!1}=e;return l?(0,a.jsx)("code",{style:{backgroundColor:"#f5f5f5",padding:"2px 4px",borderRadius:"4px"},children:s}):(0,a.jsx)(i.A,{language:n,children:s})}},7272:(e,s,n)=>{n.d(s,{So:()=>c,aW:()=>t,g5:()=>a,gq:()=>i,l3:()=>l,yN:()=>r});n(4848);const i="\nvoid USART0_init(unsigned int baud_rate)\n{\n  /* Set baud rate */\n  UBRR0H = (unsigned char)(baud_rate >> 8);\n  UBRR0L = (unsigned char)baud_rate;\n\n  /* Enable transmitter and receiver */\n  UCSR0B = (1 << TXEN0) | (1 << RXEN0);\n\n  /* Set frame format: 8 data bits, 2 stop bits, no parity */\n  UCSR0C = (1 << USBS0) | (3 << UCSZ00);\n}\n\nvoid USART0_transmit(unsigned char data) {\n    /* Wait until the buffer is empty */\n    while (!(UCSR0A & (1 << UDRE0)));\n\n    /* Load data into the buffer; transmission starts automatically */\n    UDR0 = data;\n}\n\nchar USART0_receive()\n{\n  /* Wait while the buffer is empty */\n  while (!(UCSR0A & (1 << RXC0)));\n\n  /* Return data from buffer */\n  return UDR0;\n}\n",a="\nboard_build.f_cpu = 12000000L\n",l="\nmonitor_speed = 28800\n",r="\nmonitor_echo = true\n",t="\nvoid USART_exec(unsigned char command);\n",c='\nif (strcmp(received_command, "pedestrian") == 0) {\n    // Handle traffic light sequence\n} else {\n    USART0_transmit("incorrect command");\n}\n'},7969:(e,s,n)=>{n.d(s,{A:()=>i});const i=n.p+"assets/images/avr_pwm_01-3245bf91318e95f2f01586ece2f266bd.jpg"},8325:(e,s,n)=>{n.d(s,{A:()=>i});const i=n.p+"assets/images/main-qimg-72a9c6569290abe0a85dceabaf8c7ff9-bce705736a7ef84c46ac6f32d18efb5c.gif"},9329:(e,s,n)=>{n.d(s,{A:()=>r});n(6540);var i=n(4164);const a={tabItem:"tabItem_Ymn6"};var l=n(4848);function r(e){let{children:s,hidden:n,className:r}=e;return(0,l.jsx)("div",{role:"tabpanel",className:(0,i.A)(a.tabItem,r),hidden:n,children:s})}},9646:(e,s,n)=>{n.d(s,{A:()=>i});const i=n.p+"assets/images/merged_pwm_waveforms-72cf59564a76502f5e36cd7e61eb619c.png"}}]);