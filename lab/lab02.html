<!doctype html>
<html lang="en-GB" dir="ltr" class="docs-wrapper plugin-docs plugin-id-lab docs-version-current docs-doc-page docs-doc-id-lab02/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Laboratory 2: Interrupts, Timers | Microprocessor Architecture</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://upb-fils-am-fr.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://upb-fils-am-fr.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://upb-fils-am-fr.github.io/lab/lab02"><meta data-rh="true" property="og:locale" content="en_GB"><meta data-rh="true" property="og:locale:alternate" content="fr"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-lab-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-lab-current"><meta data-rh="true" property="og:title" content="Laboratory 2: Interrupts, Timers | Microprocessor Architecture"><meta data-rh="true" name="description" content="Useful Chapters from Datasheet ATmega324"><meta data-rh="true" property="og:description" content="Useful Chapters from Datasheet ATmega324"><link data-rh="true" rel="icon" href="/img/sigla_am.ico"><link data-rh="true" rel="canonical" href="https://upb-fils-am-fr.github.io/lab/lab02"><link data-rh="true" rel="alternate" href="https://upb-fils-am-fr.github.io/lab/lab02" hreflang="en-GB"><link data-rh="true" rel="alternate" href="https://upb-fils-am-fr.github.io/fr/lab/lab02" hreflang="fr"><link data-rh="true" rel="alternate" href="https://upb-fils-am-fr.github.io/lab/lab02" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.f442cfaf.css">
<script src="/assets/js/runtime~main.c9cc2831.js" defer="defer"></script>
<script src="/assets/js/main.432a33b9.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/sigla_am.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/sigla_am.svg" alt="Microprocessor Architecture" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/sigla_am.svg" alt="Microprocessor Architecture" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Microprocessor Architecture</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/lab">Lab</a><a class="navbar__item navbar__link" href="/project">Project</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/lab/lab02" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en-GB">English</a></li><li><a href="/fr/lab/lab02" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="fr">Fran√ßais</a></li></ul></div><a href="https://github.com/UPB-FILS-AM-FR/am-website" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/lab">General Lab Rules</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/lab/lab00">Laboratory 0: Introductory Applications</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/lab/lab01">Laboratory 1: USART. Debugging</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/lab/lab02">Laboratory 2: Interrupts, Timers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/lab/lab03">Lab 3: Timers, Pulse Width Modulation (PWM)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/lab/lab04">Lab 4: Analog to Digital Converter (ADC)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/lab/lab05">Lab 5: SPI (Serial Peripheral Interface)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/lab/lab06">Lab 6: I2C (Inter-Integrated Circuit)</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Laboratory 2: Interrupts, Timers</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Laboratory 2: Interrupts, Timers</h1></header>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="useful-chapters-from-datasheet-atmega324"><strong>Useful Chapters from</strong> <a href="https://ocw.cs.pub.ro/courses/_media/pm/doc8272.pdf" target="_blank" rel="noopener noreferrer">Datasheet ATmega324</a><a href="#useful-chapters-from-datasheet-atmega324" class="hash-link" aria-label="Direct link to useful-chapters-from-datasheet-atmega324" title="Direct link to useful-chapters-from-datasheet-atmega324">‚Äã</a></h3>
<ul>
<li><strong>1. Pin Configurations</strong>
<ul>
<li>Section 1.1 - Page 2</li>
</ul>
</li>
<li><strong>7. AVR CPU Core</strong>
<ul>
<li>Section 7.3 - Page 11</li>
<li>Section 7.7 - Page 16</li>
</ul>
</li>
<li><strong>12. Interrupts</strong>
<ul>
<li>Table 12-1 - Page 61</li>
</ul>
</li>
<li><strong>13. External Interrupts</strong>
<ul>
<li>Section 13.1 - Page 67</li>
<li>Sections 13.2.4-13.2.9 - Page 69</li>
</ul>
</li>
<li><strong>16. 16-bit Timer/Counter1 and Timer/Counter3 with PWM</strong>
<ul>
<li>Sections 16.1-16.3 - Page 111</li>
<li>Section 16.5 - Page 117</li>
<li>Section 16.7 - Page 120</li>
<li>Sections 16.9.1-16.9.2 - Page 123</li>
<li>Section 16.11 - Page 132</li>
</ul>
</li>
</ul>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>The chapters are from <a href="https://ocw.cs.pub.ro/courses/_media/pm/doc8272.pdf" target="_blank" rel="noopener noreferrer">Datasheet ATmega324</a>, a document available on the <strong>desktop of the laboratory computers</strong>.<br>
<!-- -->The chapter order might be different in other versions of the datasheet!</p></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="objective"><strong>Objective</strong><a href="#objective" class="hash-link" aria-label="Direct link to objective" title="Direct link to objective">‚Äã</a></h2>
<p>This lab aims to familiarize you with <strong>hardware interrupts</strong> and <strong>timers</strong> in the ATmega324 microcontroller.<br>
<!-- -->In this session, we will use timers <strong>only for counting</strong>, without generating PWM signals.<br>
<!-- -->PWM functionality will be explored in the <strong>next laboratory</strong>.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-interrupts"><strong>1. Interrupts</strong><a href="#1-interrupts" class="hash-link" aria-label="Direct link to 1-interrupts" title="Direct link to 1-interrupts">‚Äã</a></h2>
<p>A <strong>hardware interrupt</strong> is a synchronous or asynchronous signal from a peripheral indicating the occurrence of an event that the processor must handle.<br>
<!-- -->Handling an interrupt <strong>suspends the normal execution flow</strong> of a program and triggers the execution of an <strong>Interrupt Service Routine (ISR).</strong></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="why-use-interrupts"><strong>Why Use Interrupts?</strong><a href="#why-use-interrupts" class="hash-link" aria-label="Direct link to why-use-interrupts" title="Direct link to why-use-interrupts">‚Äã</a></h3>
<p>Interrupts eliminate the need for <strong>polling loops</strong> where a processor constantly checks for an event from a peripheral.<br>
<!-- -->By using interrupts:</p>
<ul>
<li>Peripherals can notify the processor <strong>only when necessary</strong>.</li>
<li>The processor is <strong>free</strong> to execute other tasks <strong>until an event occurs</strong>.</li>
<li>The program executes <strong>more efficiently</strong>.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="handling-interrupts"><strong>Handling Interrupts</strong><a href="#handling-interrupts" class="hash-link" aria-label="Direct link to handling-interrupts" title="Direct link to handling-interrupts">‚Äã</a></h3>
<p>Before executing an <strong>ISR</strong>, the processor <strong>saves its current state</strong>:</p>
<ul>
<li><strong>Program Counter (PC)</strong></li>
<li><strong>Status registers</strong></li>
<li><strong>Variables affected by the ISR execution</strong></li>
</ul>
<p>This information is stored in <strong>memory</strong>, typically a <strong>stack</strong>.<br>
<!-- -->Once the ISR completes, the <strong>previous state</strong> is restored, and the <strong>main program resumes</strong> from where it was interrupted.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="interrupt-vector-table-ivt"><strong>Interrupt Vector Table (IVT)</strong><a href="#interrupt-vector-table-ivt" class="hash-link" aria-label="Direct link to interrupt-vector-table-ivt" title="Direct link to interrupt-vector-table-ivt">‚Äã</a></h2>
<p>To associate an interrupt with a specific <strong>ISR function</strong>, the processor uses an <strong>Interrupt Vector Table (IVT)</strong>, shown in the diagram below.</p>
<p>Each interrupt is assigned a <strong>fixed memory address</strong> where its <strong>ISR function</strong> is located.<br>
<!-- -->When an interrupt occurs, the processor jumps to its corresponding <strong>ISR address</strong> in the IVT.</p>
<p><strong>Interrupt Priority:</strong></p>
<ul>
<li><strong>Lower addresses ‚Üí Higher priority</strong></li>
<li>Interrupts at the <strong>beginning of the IVT</strong> are handled <strong>first</strong>.</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="interrupt-vector-table-for-atmega324"><strong>Interrupt Vector Table for ATmega324</strong><a href="#interrupt-vector-table-for-atmega324" class="hash-link" aria-label="Direct link to interrupt-vector-table-for-atmega324" title="Direct link to interrupt-vector-table-for-atmega324">‚Äã</a></h2>
<table><thead><tr><th>Vector No.</th><th>Program Address</th><th>Source</th><th>Interrupt Definition</th></tr></thead><tbody><tr><td>1</td><td>0000</td><td>RESET</td><td>External Pin, Power-on Reset, Brown-out Reset, Watchdog Reset, and JTAG AWR Reset</td></tr><tr><td>2</td><td>0002</td><td>INT0</td><td>External Interrupt Request 0</td></tr><tr><td>3</td><td>0004</td><td>INT1</td><td>External Interrupt Request 1</td></tr><tr><td>4</td><td>0006</td><td>INT2</td><td>External Interrupt Request 2</td></tr><tr><td>5</td><td>0008</td><td>PCINT0</td><td>Pin Change Interrupt Request 0</td></tr><tr><td>6</td><td>000A</td><td>PCINT1</td><td>Pin Change Interrupt Request 1</td></tr><tr><td>7</td><td>000C</td><td>PCINT2</td><td>Pin Change Interrupt Request 2</td></tr><tr><td>8</td><td>000E</td><td>PCINT3</td><td>Pin Change Interrupt Request 3</td></tr><tr><td>9</td><td>0010</td><td>WDT</td><td>Watchdog Time-out Interrupt</td></tr><tr><td>10</td><td>0012</td><td>TIMER2_COMPA</td><td>Timer/Counter2 Compare Match A</td></tr><tr><td>11</td><td>0014</td><td>TIMER2_COMPB</td><td>Timer/Counter2 Compare Match B</td></tr><tr><td>12</td><td>0016</td><td>TIMER2_OVF</td><td>Timer/Counter2 Overflow</td></tr><tr><td>13</td><td>0018</td><td>TIMER1_CAPT</td><td>Timer/Counter1 Capture Event</td></tr><tr><td>14</td><td>001A</td><td>TIMER1_COMPA</td><td>Timer/Counter1 Compare Match A</td></tr><tr><td>15</td><td>001C</td><td>TIMER1_COMPB</td><td>Timer/Counter1 Compare Match B</td></tr><tr><td>16</td><td>001E</td><td>TIMER1_OVF</td><td>Timer/Counter1 Overflow</td></tr><tr><td>17</td><td>0020</td><td>TIMER0_COMPA</td><td>Timer/Counter0 Compare Match A</td></tr><tr><td>18</td><td>0022</td><td>TIMER0_COMPB</td><td>Timer/Counter0 Compare Match B</td></tr><tr><td>19</td><td>0024</td><td>TIMER0_OVF</td><td>Timer/Counter0 Overflow</td></tr><tr><td>20</td><td>0026</td><td>SPI_STC</td><td>SPI Serial Transfer Complete</td></tr><tr><td>21</td><td>0028</td><td>USART0_RX</td><td>USART0 Rx Complete</td></tr><tr><td>22</td><td>002A</td><td>USART0_UDRE</td><td>USART0 Data Register Empty</td></tr><tr><td>23</td><td>002C</td><td>USART0_TX</td><td>USART0 Tx Complete</td></tr><tr><td>24</td><td>002E</td><td>ANALOG_COMP</td><td>Analog Comparator</td></tr><tr><td>25</td><td>0030</td><td>ADC</td><td>ADC Conversion Complete</td></tr><tr><td>26</td><td>0032</td><td>EE_READY</td><td>EEPROM Ready</td></tr><tr><td>27</td><td>0034</td><td>TWI</td><td>Two-Wire Serial Interface</td></tr><tr><td>28</td><td>0036</td><td>SPM_READY</td><td>Store Program Memory Ready</td></tr><tr><td>29</td><td>0038</td><td>USART1_RX</td><td>USART1 Rx Complete</td></tr><tr><td>30</td><td>003A</td><td>USART1_UDRE</td><td>USART1 Data Register Empty</td></tr><tr><td>31</td><td>003C</td><td>USART1_TX</td><td>USART1 Tx Complete</td></tr><tr><td>32</td><td>003E</td><td>TIMER3_CAPT</td><td>Timer/Counter3 Capture Event</td></tr><tr><td>33</td><td>0040</td><td>TIMER3_COMPA</td><td>Timer/Counter3 Compare Match A</td></tr><tr><td>34</td><td>0042</td><td>TIMER3_COMPB</td><td>Timer/Counter3 Compare Match B</td></tr><tr><td>35</td><td>0044</td><td>TIMER3_OVF</td><td>Timer/Counter3 Overflow</td></tr></tbody></table>
<hr>
<p>From the table above, besides <strong>internal component interrupts</strong> (timers, serial interfaces, analog-to-digital converters), there are also <strong>external peripheral interrupts</strong>:<br>
<!-- -->‚úÖ <strong>INT0-INT2</strong><br>
<!-- -->‚úÖ <strong>PCINT0-PCINT3</strong></p>
<p>The <strong>difference</strong> between these two types of external interrupts lies in their capabilities and level of granularity.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="intn-interrupts"><strong>INTn Interrupts</strong><a href="#intn-interrupts" class="hash-link" aria-label="Direct link to intn-interrupts" title="Direct link to intn-interrupts">‚Äã</a></h3>
<ul>
<li>Signals for <strong>INTn</strong> interrupts come from:<!-- -->
<ul>
<li><strong>Port D</strong> (pins 2, 3)</li>
<li><strong>Port B</strong> (pin 2)</li>
</ul>
</li>
<li>They can trigger an interrupt:<!-- -->
<ul>
<li>On <strong>rising</strong> or <strong>falling edge</strong></li>
<li>Or on <strong>level 0</strong>, depending on the configuration.</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pcintn-interrupts"><strong>PCINTn Interrupts</strong><a href="#pcintn-interrupts" class="hash-link" aria-label="Direct link to pcintn-interrupts" title="Direct link to pcintn-interrupts">‚Äã</a></h3>
<ul>
<li><strong>PCINTn</strong> interrupts trigger on <strong>both edges</strong> (hence the name <strong>Pin Change INTerrupt</strong>).</li>
<li><strong>8 pins are multiplexed</strong> onto a <strong>single interrupt</strong>.</li>
<li>While <strong>PCINT signals</strong> can be individually enabled, the exact pin that triggered the interrupt must be determined by checking the <strong>PINn register</strong>.</li>
<li><strong>Multiple simultaneous pin changes cannot be distinguished.</strong></li>
</ul>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>For <strong>pin change interrupts</strong>, do not confuse the <strong>interrupt vector (e.g., PCINT0)</strong> with the <strong>actual interrupt (e.g., PCINT0 (PA0))</strong>.<br>
<!-- -->The mapping between vectors and interrupts is found in <strong>Section 30, Page 555</strong> of the <a href="https://ocw.cs.pub.ro/courses/_media/pm/doc8272.pdf" target="_blank" rel="noopener noreferrer">datasheet</a>.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="external-interrupt-pins-on-atmega324"><strong>External Interrupt Pins on ATmega324</strong><a href="#external-interrupt-pins-on-atmega324" class="hash-link" aria-label="Direct link to external-interrupt-pins-on-atmega324" title="Direct link to external-interrupt-pins-on-atmega324">‚Äã</a></h2>
<p><img decoding="async" loading="lazy" alt="External Interrupt Pins on ATmega324" src="/assets/images/irq_pins-5d72456dd4d2457ee4ab5516aa62e4e7.png" width="778" height="598" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>When an interrupt occurs, besides saving the state, the processor <strong>disables</strong> interrupts, and upon returning from the interrupt handler, it <strong>re-enables</strong> them.<br>
<!-- -->Interrupts can also be manually re-enabled <strong>within the handler</strong> (e.g., if we are inside a handler for receiving a frame over a serial interface and want to enable a timer interrupt).</p></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="11-using-interrupts"><strong>1.1. Using Interrupts</strong><a href="#11-using-interrupts" class="hash-link" aria-label="Direct link to 11-using-interrupts" title="Direct link to 11-using-interrupts">‚Äã</a></h2>
<p>To enable an interrupt, follow these steps:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1Ô∏è‚É£-enable-the-global-interrupt-mechanism"><strong>1Ô∏è‚É£ Enable the global interrupt mechanism</strong><a href="#1Ô∏è‚É£-enable-the-global-interrupt-mechanism" class="hash-link" aria-label="Direct link to 1Ô∏è‚É£-enable-the-global-interrupt-mechanism" title="Direct link to 1Ô∏è‚É£-enable-the-global-interrupt-mechanism">‚Äã</a></h3>
<p>Interrupt handling must be explicitly enabled (bit <strong>I - Global Interrupt Enable</strong> in the <code>SREG</code> register).<br>
<!-- -->To set and clear this bit, use the following helper functions:</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Enable interrupts</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sei</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Disable interrupts</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cli</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2Ô∏è‚É£-configure-the-peripheral-that-will-generate-interrupts"><strong>2Ô∏è‚É£ Configure the peripheral that will generate interrupts</strong><a href="#2Ô∏è‚É£-configure-the-peripheral-that-will-generate-interrupts" class="hash-link" aria-label="Direct link to 2Ô∏è‚É£-configure-the-peripheral-that-will-generate-interrupts" title="Direct link to 2Ô∏è‚É£-configure-the-peripheral-that-will-generate-interrupts">‚Äã</a></h3>
<p>For example, <code>INT0</code>, <code>INT1</code>, and <code>INT2</code> are configured via the <strong>EICRA register</strong><br>
<!-- -->(External Interrupt Control Register A, section <strong>13.2.1, page 67</strong> in <a href="https://ocw.cs.pub.ro/courses/_media/pm/doc8272.pdf" target="_blank" rel="noopener noreferrer">datasheet</a>.</p>
<p>For <strong>pin change interrupts</strong>, use the <strong>PCICR register</strong>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="eicra-register"><strong>EICRA Register</strong><a href="#eicra-register" class="hash-link" aria-label="Direct link to eicra-register" title="Direct link to eicra-register">‚Äã</a></h3>
<p><img decoding="async" loading="lazy" alt="EICRA Register" src="/assets/images/eicra-53513bf433f9f0b1d4734bd69f2ad9e1.png" width="1059" height="187" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="interrupt-trigger-modes"><strong>Interrupt Trigger Modes</strong><a href="#interrupt-trigger-modes" class="hash-link" aria-label="Direct link to interrupt-trigger-modes" title="Direct link to interrupt-trigger-modes">‚Äã</a></h3>
<p><img decoding="async" loading="lazy" alt="EICRA Modes" src="/assets/images/eicra2-c12dcddceec2dc82e5b76e4eb30dcbc1.png" width="1078" height="277" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-examples"><strong>Configuration Examples</strong><a href="#configuration-examples" class="hash-link" aria-label="Direct link to configuration-examples" title="Direct link to configuration-examples">‚Äã</a></h4>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// External interrupt: Set INT0 to trigger on ANY logic change</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EICRA </span><span class="token operator" style="color:#393A34">|=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> ISC00</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Pin change interrupt: Enable the pin change interrupt, set PCIE1 to enable PCMSK1 scan</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PCICR </span><span class="token operator" style="color:#393A34">|=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> PCIE1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>An <strong>external interrupt</strong> can be configured to trigger on:</p><ul>
<li><strong>Rising edge</strong></li>
<li><strong>Falling edge</strong></li>
<li><strong>Any level change</strong></li>
</ul><p>üìå See <strong>Table 13-1</strong> in the <a href="https://ocw.cs.pub.ro/courses/_media/pm/doc8272.pdf" target="_blank" rel="noopener noreferrer">datasheet</a> for details.</p><p>üìå <strong>Pin change interrupts</strong> trigger on <strong>any level change</strong>, so the <strong>signal value must be explicitly checked in the handler</strong>.</p></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3Ô∏è‚É£-implement-the-interrupt-service-routine-isr"><strong>3Ô∏è‚É£ Implement the Interrupt Service Routine (ISR)</strong><a href="#3Ô∏è‚É£-implement-the-interrupt-service-routine-isr" class="hash-link" aria-label="Direct link to 3Ô∏è‚É£-implement-the-interrupt-service-routine-isr" title="Direct link to 3Ô∏è‚É£-implement-the-interrupt-service-routine-isr">‚Äã</a></h3>
<p>Interrupt handlers must be mapped to <strong>fixed memory addresses</strong> in the <strong>interrupt vector table</strong>.<br>
<!-- -->Use the <code>ISR()</code> macro to define them, passing the appropriate <strong>interrupt type</strong>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-handling-int0-and-pcint1-interrupts"><strong>Example: Handling INT0 and PCINT1 interrupts</strong><a href="#example-handling-int0-and-pcint1-interrupts" class="hash-link" aria-label="Direct link to example-handling-int0-and-pcint1-interrupts" title="Direct link to example-handling-int0-and-pcint1-interrupts">‚Äã</a></h4>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">ISR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">INT0_vect</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Code for external interrupt</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">ISR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">PCINT1_vect</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Code for pin change interrupt</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">PINB </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> PB1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token comment" style="color:#999988;font-style:italic">// Interrupt triggered by pin PB1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="enabling-interrupts-and-testing-the-program"><strong>Enabling Interrupts and Testing the Program</strong><a href="#enabling-interrupts-and-testing-the-program" class="hash-link" aria-label="Direct link to enabling-interrupts-and-testing-the-program" title="Direct link to enabling-interrupts-and-testing-the-program">‚Äã</a></h2>
<p>To enable external interrupts, configure the <strong>External Interrupt Mask Register (EIMSK)</strong>:</p>
<ul>
<li>Bits <strong>INT2:0</strong> control whether external interrupts (<strong>INT0-INT2</strong>) are enabled.</li>
</ul>
<p>For <strong>pin change interrupts</strong>, configure the <strong>corresponding register</strong> (e.g., <code>PCMSK1</code> for pin change interrupts on specific pins).</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Enable external interrupt INT0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EIMSK </span><span class="token operator" style="color:#393A34">|=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> INT0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">     </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Enable pin change interrupt PCINT9 (PB1)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PCMSK1 </span><span class="token operator" style="color:#393A34">|=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> PCINT9</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Enable global interrupts</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sei</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><p>üìå <strong>Additional Registers for Interrupt Management</strong></p></summary><div><div class="collapsibleContent_i85q"><p>For a <strong>complete description</strong> of these registers, see the <a href="https://ocw.cs.pub.ro/courses/_media/pm/doc8272.pdf" target="_blank" rel="noopener noreferrer">datasheet</a><br>
<!-- -->(<em>Interrupts</em>, <em>External Interrupts</em> chapters).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="status-register-sreg"><strong>Status Register (SREG)</strong><a href="#status-register-sreg" class="hash-link" aria-label="Direct link to status-register-sreg" title="Direct link to status-register-sreg">‚Äã</a></h3><ul>
<li>Stores <strong>status flags</strong> set by the ALU.</li>
<li>Contains <strong>I bit</strong>, which enables/disables global interrupts.</li>
<li><strong>Not saved</strong> when an interrupt occurs.</li>
<li>Described in the <em>AVR CPU Core</em> chapter.</li>
</ul><p>üìå <strong>SREG Register</strong>
<img decoding="async" loading="lazy" alt="SREG Register" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAj4AAABVCAYAAABJnu4cAAAABHNCSVQICAgIfAhkiAAAE59JREFUeJzt3U9oE+n/B/D3/PhdNnqRKrJfltSlB5OD7JZWcHLQFnZloVkPTlgMKNQiNl3QQ1cPTnq07SFScIW16UGFFVKWNofdBIouNPHQFHZKKy4ksnhIcA+LDR7czB6f7yHfeTZJ659dk0xm8n5B0E6ayeeZ59PJJ888yaMIIQSIiIiIusD/2R0AERERUbuw8CEiIqKuwcKHiIiIugYLHyIiIuoaLHyIiIioa7DwISIioq7BwoeIiIi6BgsfIiIi6hosfIiIiKhrsPAhIiKirsHCh4iIiLoGCx8iIiLqGi0pfBRFqbsFAgFsbGzI+0qlEkzTxOLiYiuengAUCoUd/aAoit1hNc3CwoLMrUKhYHc4TdHYZxMTE3aH1HRWG92iVCphYmICiqIgFAq5JhfL5bJsV+35203clIcAYJomotGoPHeUy2W7Q+pYLRvxMQwDQghUKhWMjo7i0qVLAIB8Pg+v14tSqYRwONyqp+96Pp8P+Xxe3iKRCOLxuN1hNUU6ncaDBw9QqVQQjUYxNTVld0hN8ccffyASicg+u379ut0hNZVpmhgbG7M7jKaanZ1Ff38/hBAIhUKuad/U1JRs1+zsLAYHB+0OqanS6bTdITTd/fv3AQBCCPT392Nubs7miDqYaAEAwjAM+bNhGMJ6KgCiWCwKAPJGrWUYhlBVVVQqFbtDaQpN00QmkxFCCFGpVOT/nS6RSIhYLGZ3GC0Ti8VEJBJx1d88AJHP54UQQuTzede0zTpP1/5stdPprBx0S19ZVFWVr7vWayztruVzfEzTxOrqKnRdr9uWz+etwqvVIXS92dlZRKNReDweu0NpiuXlZdy6dQuKouCzzz7DwYMH7Q6pKZ4/f46rV6+67hIeUL3ElUwmceHCBbtDaapisQifzwcA2NragqZpNkfUHEIIeL1eAMDi4iJUVZXtdLrbt2/L1x83yeVy2LNnDwDIvnPTOaSZ/r9VO24cGjUMo1VPRW+wsbGB5eVlLC0t2R1KUx07dgxLS0vIZrPw+/2uKKD9fj9SqRRGRkaQTqdd0y7rEtedO3fsDqXprMv2vb29AOCay8lAdf7S7OwsHj9+7Mq+o+7V8jk+QggkEgnXXSN2imQyiVgsZncYTTc8PAwAOHHiBAB3vLPp6+uT7RoZGQFQffFxulKphFwuB7/fD7/fD8A9E0uz2Sz2798PIQTy+TzGx8ddManUKub6+vrw888/u2a0x81UVUWlUgHw93mD/ba7tn2cXVXVdj0V1ZiZmcHRo0ftDqOpYrEYVldXYZom0um0a4bhp6am5ARFq13WkLWT+Xw++SbIbZe4b926hdXVVQCQLzoffPCBnSE1xezsLOLxOK5cueKaS+RuNzo6imQyCQBYWVmpm15C9VpW+AwODsqP5S4tLdUNlXo8Hni9XmiahkAg0KoQup5V9X/88cc2R9Jc58+fx7Nnz7Bnzx7cvXvXNcPwc3NzePDgARRFwd27d135dQ9uexG9fv067t69C0VRMDs7C8MwXNHG+fl5jI+P1329ghtGHy1u6KNGZ8+eBVAdTd3c3MTk5KTNEXUuRbjlrRcRERHRW/Cbm4mIiKhrsPAhIiKirsHCh4iIiLpGy77Hh3bnlo/xEhERWZw0XZgjPkRERNQ1WPgQERFR12DhQ0RERF2Dc3xs5qTrou9CURTXtQlwb7sA97aN7XIet7bNje1y8nxVjvi4XDQadXSCNioUCnXfJlt7czpFURCNRuXPbum7crks26IoCm7cuAHTNO0O672FQiEoiiLbUiqVoCgKFhYWbI7s/SmKgkAgINu2sLDgily0+sxt5w6guiD1xMQEFEVBKBRCNpu1O6TXWlxcRCAQkHmWTqflfY19EwqF5FqMVh423m8plUryGAQCgdd++z1HfMhRDhw4gFQqBQAIBoPQNA3nz5+3OSp6k6mpKTx+/BiJRAIA8O233+Lly5eYnp62ObL3EwqFsLy8jFKpBJ/PhydPngAAjh8/bnNkzZHL5bC6uioXzHWDS5cuyfPF2toaZmZmEIlEbI7q/RUKBQwODkJVVcTjcWxubmJoaAiZTEYu5NwpstkswuEwYrEYotEo1tbWEAwGYRgGBgYGAACRSATBYBCvXr1COBwGACwtLcl9WK8BALB3714A1aLnzJkzAIBEIoEnT57Ix1rbLSx8yFF6enrqTsSHDx921YnZjebn56HrOk6dOgWPx4MPP/wQT58+tTus9/bpp58CALa2tuDz+bC2tuaaBXMt09PTGB4etjuMprGKANM0MT09DVVVcf36dZujen/ff/89gOpIitfrhWmaePHiBX755ZeOK3ysv/2vvvoKXq8XIyMj6O3txZ9//il/p7+/X57Xnzx5gpmZmbp97HbO/+GHH5DL5VAsFuH1emWxk81mWfgQdbKnT5/KYV83FAcAEIvFcPXqVfnu+sSJE3JBRSfz+XzQNA1LS0s4deoUZmZmEIvF7A6raWKxGJLJJH788Ue7Q2m66elp5HI5ZDIZ9PT02B3Oe1tdXYWmafB6vQCqi7DWjpB0EmtUp7e3F6qq4vTp0wgGg3VvGDY3N5FOp/Hq1atd/65qL4319fXB5/MhmUxCVVV5DAC8flRZUFsBqLu1mq7rbXkeS7ufS9f1tj1XO55jt1s7nrfVMpmMiMViQlXVtvVbO9qVSCQEAJHJZAQAYRhGy5+zXTkRj8dFKpWS/eWWXLTaFIvFWv5clla3S1VVoWlaS5+j0fucp/L5vIjH4yISicjHW387u50Drfvi8fiO++LxuHycdQwMw3hjbJzcTNRBdF2HEAJCCOi6bnc4TWFN9r1y5QrW1tag6/qOoWunsi53Xbt2DaqqynezbjE8PAxVVV3TX6VSSc4N/Prrr+0Op2mGh4exvLyMcrkMoHopr/HDEp0im83i0aNHuHjxIm7fvo3t7W0A1cnZlng8DiEEKpUKACCZTNbtwzpHCiFw8eJFANV5QcvLyzBNU84FVVV11xh4qYuIWqpYLOLevXu4fPkygOqwvFuKOp/PB1VVkcvlXHWZy+LxeBCNRhEMBu0OpSkmJycBAMeOHcPq6qrc7vR5gufOncPMzAy+/PJLjI6O4sGDBwCA06dP2xzZTnv37sX4+DiKxSICgQDy+TyA6nzNRh6PZ9d91F7qAqqF34ULFzA/P49vvvkGJ06cwJMnT5DL5XZ9PEd8iKilotEohoeHEQ6HEQ6HMTw83JHvRP+t0dFRAHDVJOBaIyMj0DTN7jCaYnl5GQBw9epVBINBeXM6n88HwzDwn//8B+Pj4wCATCbTkSOQAwMDSKVSePr0KYLBIJLJJFKp1GsnYauqumO+Y23fBYNB/PXXXxgYGIBhGAAgP81V++mvWsr/ro1RmzR+Z4TbDr8bv6gLcG+7APe2je1yHre2zY3tcvJrGUd8iIiIqGuw8CEiIqKuwcKHiIiIugYLHyIiIuoanNzcZm5ZEI+IiMjipFKCIz5ERETUNVj4EBERUddg4UNERERdg0tWtJmTroMSERG5TUtGfBRF2XFrXFvj3yiVSnWTg2/cuLFj34qiyEURASAUCtX93LifxcVFmKb53rHZpfE4h0IhFAoFeX+5XJbbLdZxs6TT6Y6bdP22HCqXywgEAv+q/+1UKBTe2mdW/zi9z5iLzsvFxvM0c7Gz2+WWXGy3ll3qMgxDrp5qGAaCwSBKpdJ77bOxQEkmk9B1HWtrawAgE9taoM00TSwvL+9Yr8Tr9cqF0cLh8HvHZbfaY33y5EmMjY3J+9bX16Fpmly1Fvh7pVvreFkrZneaN+XQ+vo6RkdH/1X/28labbh2deHGPksmkzAMw/F9xlx0Vi7m8/kd52nmYme3yy252G5tmeNjHeAXL17ANE1Eo1FZbVsdtrGxgVAoBEVREAgEkM1mAVQ7zdp+8+ZNuc9CoYBPPvkEgUBArrK7tbUFXdexvLyMcrks9+33+6EoCqLRKAKBAEqlEvx+v6z2/X4/gGq1PDExAUVRMDEx4ciRoIGBgboVaVOpFK5duwagOtJVLpeRy+Wg6zq2trYAVFfLDgQCtsT7rmpzCKi26/jx4+/c/52sts+svLZidnqfMRedk4s+nw/A3+1iLjqjXYD7crHV2lL4WEXMoUOHcP/+fQDVdxsnT57E7OwsAGBwcBCXLl2CEAK3bt3C0NAQAGBsbAznz5+HEAL9/f1yn48ePUIwGMSRI0eQy+VQLpeRzWYRCAQQiUTw66+/YmtrC5qmyaXt9+3bhzt37siCZmlpCQDk6M/c3Bz6+vpQqVTQ19eH7777rvUHp8k2NjbkSsrlchnz8/MYGBiApml49uwZ1tfXEYlEZHFp/cEfOXLE5sjfrDaHrHb5fL5/1P+dqrbPrLz2eDyO7zPmorNy0RoZOHToEADmohPa5dZcbLWWfIHhbtdFdV3H9PQ0AoEA7ty5A5/Ph3K5jP3790MIgVKphLW1NTx//hzPnj3D/Pw8isUient75YTgQqEAv98PIQQURcH29jZ6enqgKAoymQyGhoawvb2Nhw8f4vnz53j58iV6e3tx8eJFKIqCYrEIr9e7Yz/5fB4+n69un4VCAWNjY3K4sFPtdqwTiQTOnDmDdDqN33//HRcvXsTCwgKKxSL27duHjz76CIFAAL29vfK4ddqk6zflUG27rN99W/93io2NDQwODu7YbvVZbQ66oc+Yi87KRatdAJiLDmmXG3Kx7UQLABCGYcif8/m8ACD/bbwVi0WhaZrQdV2kUimRSqUEALG9vS0AiEqlIoQQolgsyv1EIhG5f13XhaZpQlVV+XyqqgpVVWUc1uNq46nd/rrYOl3jsU4kEjJuXddlmw3DkMfE2qaqqjzuneZNOVTbLiHerf87hWEYO/LK6rPGvHZ6nzEXnZWLtedX5qIz2uWWXGy3thQ+tdtUVRWpVEoIIer+uKzOq1QqIh6PyyTVNE0kEom67fF4XO5DCCELpVgsVvd8tUXT2wqfSqUiAIhMJiOEqP5BdGLiN2o81tbJrFKpyIQXQsj21Z7oYrGYAFB3LDvF23Ko1rv0f6fYrfCxtjXmtdP7jLn49+86JRetdjEXndGu2m1OzsV2a9n3+OzZs2fHtt9++w2Li4uYnJxEMBiEqqq4desWgOqkLGuyVTweh6qquHHjBubm5jA5OYlwOIxIJAIAuHfvHn766Se5X+s67PDwsNwWiUTw4sWLuuuY1v9rt0UiEXnZK5/PY2pqCkNDQ9A0DdevX2/W4Wip2mN94MABANWJeadPn5bbrev0hw8fltuOHj0KAB17HXu3HLp06VJdu4B37/9OsFubrD4bHx/H9va23O70PmMuVjkpF4HqebrxHOv0PmMuVnVqLrYbFyklIiKirsElK4iIiKhrsPAhIiKirsHCh4iIiLoGCx8iIiLqGix8iIiIqGuw8CEiIqKuwcKHiIiIugYLHyIiIuoaLHyIiIioa7Sk8FEUBYVC4bX3l0olucrs4uIiTNOs2/a2x1gWFxcRCATeuu1t+3GrcrmMiYkJKIqCaDQK0zTtDqkpTNNENBqFoiiYmJhAuVy2O6SmcGu7AOai07i1XQBzkVo44lOpVF57n9frRT6fBwCEw2GUSqW6bbvZLTkDgQByuRxKpZLctrS0hNHR0X+0H7eam5tDf38/rFVJ7t+/b3NEzWG1QwiB/v5+zM3N2RxRc7i1XQBz0Wnc2i6AuUhAy1dnByB0XZerwmYyGVEsFgUAoWma3G5tE0LIlWYBiEQiIYSoX1G9lrV6uxBCbG9v163Cbq1Ou9t+ap/PirNYLIpKpSLj1TRNFIvFVhyitrDaJITYdfVep1JVVeZXYz86mVvbJQRz0Wnc2i4hmIskRFvm+PT29qJSqSCTyWBoaEiOuiwtLQEA8vl83UjM4OAg7ty5g+3tbTki9DqhUAjZbBYAsL6+DlVV4fP5YJomgsEgisXirvvZbeTHNE1ZNVcqFZw8eRKzs7PvfwBsYF1q9Hq9AKor+uZyOTtDappcLidXKLba96ZLq07h1nYxF53Hre1iLhLQpsnNX3zxBTweDw4ePPhOv5/P5/Ho0SM5VPemy1Off/455ufnUS6XkUqlcPnyZQCAx+OBYRhYWVl5p/1Y7t27h3PnzsHj8UDTNMzPz79TzERERNT52lL4/NN5NWNjYwCA06dPv/V3e3p6EIlE8PDhQ8zPz8uJzaZpYnBw8J33Y8nlcvD7/VAUBfv37weAN444dSqfzwfg79grlQpUVbUzpKZRVVXOIbPaZ7XXydzaLuai87i1XcxFAjrw4+ylUgm5XA6apr3zY4LBIMLhMDRNk0N829vbAPDa/Rw4cABAdYZ/Op2W21VVRSqVghAC+XwekUhE7tNpdF3HysoKACCZTL5x0reTjI6OIplMAgBWVlag67rNETWHW9sFMBedxq3tApiL1MLCx7rWCFQvO+32LwBEIhH4/X65zev1Ih6PY//+/Ugmk4hEIrh582bdYxodO3YMQHW+j+Vt++np6ZH3r62tybgWFxdx9+5dKIqCsbExXLhwoRmHwxaTk5PY3NyUH98/e/aszRE1h9UORVGwubmJyclJmyNqDre2C2AuOo1b2wUwFwlQhPjfZ/qIiIiIXK7jLnURERERtQoLHyIiIuoaLHyIiIioa7DwISIioq7BwoeIiIi6BgsfIiIi6hosfIiIiKhrsPAhIiKirsHCh4iIiLoGCx8iIiLqGv8Fa7jiz90CG6gAAAAASUVORK5CYII=" width="574" height="85" class="img_ev3q"></p><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="mcu-control-register-mcucr"><strong>MCU Control Register (MCUCR)</strong><a href="#mcu-control-register-mcucr" class="hash-link" aria-label="Direct link to mcu-control-register-mcucr" title="Direct link to mcu-control-register-mcucr">‚Äã</a></h3><ul>
<li><code>IVSEL</code> bit: Determines the <strong>placement of the interrupt vector table</strong><br>
<!-- -->(<code>0</code> = Flash memory start, <code>1</code> = Boot Loader section).</li>
<li><code>IVCE</code> bit: Enables writing to the <code>IVSEL</code> bit.</li>
</ul><p>üìå <strong>MCUCR Register</strong>
<img decoding="async" loading="lazy" alt="MCUCR Register" src="data:image/png;base64,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" width="818" height="112" class="img_ev3q"></p><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="external-interrupt-mask-register-eimsk"><strong>External Interrupt Mask Register (EIMSK)</strong><a href="#external-interrupt-mask-register-eimsk" class="hash-link" aria-label="Direct link to external-interrupt-mask-register-eimsk" title="Direct link to external-interrupt-mask-register-eimsk">‚Äã</a></h3><ul>
<li>Bits <strong>INT2:0</strong> control whether external interrupts are enabled.</li>
<li>If <code>INT2:0</code> <strong>AND</strong> the <code>I</code> bit in <code>SREG</code> are set to <code>1</code>,<br>
<!-- -->external interrupts are <strong>enabled</strong> on the corresponding pin.</li>
</ul></div></div></details>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="12-using-interrupts-in-avr-gcc"><strong>1.2 Using Interrupts in avr-gcc</strong><a href="#12-using-interrupts-in-avr-gcc" class="hash-link" aria-label="Direct link to 12-using-interrupts-in-avr-gcc" title="Direct link to 12-using-interrupts-in-avr-gcc">‚Äã</a></h2>
<p>The <strong>avr-libc</strong> library provides the <code>&lt;avr/interrupt.h&gt;</code> interface<br>
<!-- -->for defining <strong>interrupt service routines (ISRs)</strong>.</p>
<p>Each microcontroller has a <strong>specific vector table</strong>,<br>
<!-- -->declared in the corresponding <strong>IO header file</strong><br>
<!-- -->(for <strong>ATMega324</strong>, see <code>iom324.h</code>).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="common-interrupt-vectors"><strong>Common Interrupt Vectors</strong><a href="#common-interrupt-vectors" class="hash-link" aria-label="Direct link to common-interrupt-vectors" title="Direct link to common-interrupt-vectors">‚Äã</a></h3>
<table><thead><tr><th>Interrupt</th><th>Vector</th><th>Description</th></tr></thead><tbody><tr><td>TIMER1_COMPA</td><td>TIMER1_COMPA_vect</td><td>Compare Match on Timer 1, Threshold A</td></tr><tr><td>TIMER1_COMPB</td><td>TIMER1_COMPB_vect</td><td>Compare Match on Timer 1, Threshold B</td></tr><tr><td>TIMER1_OVF</td><td>TIMER1_OVF_vect</td><td>Timer 1 Overflow</td></tr><tr><td>PCINT1</td><td>PCINT1_vect</td><td>Pin Change Interrupt on Port B</td></tr><tr><td>...</td><td>...</td><td>...</td></tr></tbody></table>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="defining-an-isr"><strong>Defining an ISR</strong><a href="#defining-an-isr" class="hash-link" aria-label="Direct link to defining-an-isr" title="Direct link to defining-an-isr">‚Äã</a></h3>
<p>Use the <code>ISR()</code> macro to create an interrupt handler:</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;avr/interrupt.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">ISR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">INT0_vect</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Interrupt handling code</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="interrupt-handling-rules"><strong>Interrupt Handling Rules</strong><a href="#interrupt-handling-rules" class="hash-link" aria-label="Direct link to interrupt-handling-rules" title="Direct link to interrupt-handling-rules">‚Äã</a></h3>
<p>‚úÖ <strong>No return value</strong>: The processor resumes execution <strong>where it left off</strong><br>
<!-- -->‚úÖ <strong>Keep execution time short</strong>: The ISR <strong>blocks</strong> main program execution<br>
<!-- -->‚úÖ <strong>Handle shared variables carefully</strong>:</p>
<ul>
<li><strong>Use <code>volatile</code></strong> for shared variables, so the compiler does not optimize them away.</li>
<li><strong>Beware of race conditions</strong> when modifying <strong>multi-byte (16/32-bit) variables</strong>.</li>
</ul>
<hr>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><p>üìå <strong>Interrupts can be declared with specific flags</strong></p></summary><div><div class="collapsibleContent_i85q"><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;avr/interrupt.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">ISR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vector</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Interrupt handling code</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>ISR()</code> macro:</p><ul>
<li>Defines the handler for a <strong>specific peripheral</strong>.</li>
<li><strong>Saves the <code>SREG</code> register</strong> before execution.</li>
<li>Calls the <strong><code>reti</code></strong> instruction when finished.</li>
</ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="isr-flags"><strong>ISR Flags</strong><a href="#isr-flags" class="hash-link" aria-label="Direct link to isr-flags" title="Direct link to isr-flags">‚Äã</a></h3><table><thead><tr><th>Flag</th><th>Description</th></tr></thead><tbody><tr><td><strong>ISR_BLOCK</strong></td><td><strong>Default behavior</strong>: Global interrupts are disabled inside the ISR.</td></tr><tr><td><strong>ISR_NOBLOCK</strong></td><td>Allows <strong>nested interrupts</strong> (useful for prioritizing interrupts).</td></tr><tr><td><strong>ISR_NAKED</strong></td><td><strong>Omits prologue/epilogue</strong> (no <code>SREG</code> save, no <code>reti</code> call).</td></tr><tr><td><strong>ISR_ALIASOF</strong></td><td>Makes an ISR <strong>alias</strong> of another ISR.</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-aliasing-interrupts"><strong>Example: Aliasing Interrupts</strong><a href="#example-aliasing-interrupts" class="hash-link" aria-label="Direct link to example-aliasing-interrupts" title="Direct link to example-aliasing-interrupts">‚Äã</a></h4><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;avr/interrupt.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">ISR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">INT0_vect</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// INT0 interrupt handler</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">ISR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">INT1_vect</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ISR_ALIASOF</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">INT0_vect</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// INT1 uses the same handler as INT0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="additional-helper-functions"><strong>Additional Helper Functions</strong><a href="#additional-helper-functions" class="hash-link" aria-label="Direct link to additional-helper-functions" title="Direct link to additional-helper-functions">‚Äã</a></h3>
<table><thead><tr><th>Function</th><th>Description</th></tr></thead><tbody><tr><td><strong><code>sei()</code></strong></td><td><strong>Enables</strong> global interrupts (<code>I</code> bit in <code>SREG</code> = 1).</td></tr><tr><td><strong><code>cli()</code></strong></td><td><strong>Disables</strong> global interrupts (<code>I</code> bit in <code>SREG</code> = 0).</td></tr><tr><td><strong><code>reti()</code></strong></td><td><strong>Returns from an ISR</strong>, re-enabling interrupts.</td></tr></tbody></table>
<hr>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p><strong>‚ö† Active interrupts without an ISR will trigger a system Reset!</strong><br>
<!-- -->If an enabled interrupt <strong>has no handler</strong>, the system will <strong>reset</strong>.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-timer"><strong>2. Timer</strong><a href="#2-timer" class="hash-link" aria-label="Direct link to 2-timer" title="Direct link to 2-timer">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="21-how-a-timer-works"><strong>2.1. How a Timer Works</strong><a href="#21-how-a-timer-works" class="hash-link" aria-label="Direct link to 21-how-a-timer-works" title="Direct link to 21-how-a-timer-works">‚Äã</a></h3>
<p>A <strong>Timer/Counter</strong> measures fixed time intervals and can trigger <strong>interrupts</strong> when the measured interval expires.<br>
<!-- -->Once initialized, a timer operates <strong>independently</strong> from the CPU, eliminating the need for delay loops.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="basic-timer-components-in-atmega324"><strong>Basic Timer Components in ATmega324</strong><a href="#basic-timer-components-in-atmega324" class="hash-link" aria-label="Direct link to basic-timer-components-in-atmega324" title="Direct link to basic-timer-components-in-atmega324">‚Äã</a></h3>
<ol>
<li><strong>Counter Register (<code>TCNT</code>)</strong> - Measures time intervals and increments at a defined frequency.</li>
<li><strong>Prescaler</strong> - Divides the clock frequency based on the application&#x27;s needs.</li>
<li><strong>Compare Register (<code>OCRn</code>)</strong> - Stores a threshold value. If <code>TCNT</code> matches this value, an <strong>interrupt is generated</strong>.</li>
</ol>
<p>üìå <strong>Timer Functional Diagram (ATmega324)</strong><br>
<img decoding="async" loading="lazy" alt="Timer Functional Diagram" src="/assets/images/timer_block-c6ddec9e9a14445cb156194f3f355a09.png" width="660" height="492" class="img_ev3q"></p>
<p>ATmega324 has <strong>three timers</strong>:</p>
<ul>
<li><strong>Two 8-bit timers</strong> (Timer0 &amp; Timer2)</li>
<li><strong>One 16-bit timer</strong> (Timer1)</li>
</ul>
<p>Timers can also operate in <strong>PWM mode</strong> to generate <strong>variable voltage control signals</strong>, which will be explored in the next lab.</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="22-timer-operating-modes"><strong>2.2. Timer Operating Modes</strong><a href="#22-timer-operating-modes" class="hash-link" aria-label="Direct link to 22-timer-operating-modes" title="Direct link to 22-timer-operating-modes">‚Äã</a></h3>
<p>Timers can operate in various <strong>modes</strong>, each defining:</p>
<ul>
<li>The counting range.</li>
<li>Counting behavior (<strong>increment-only</strong> or <strong>increment/decrement</strong>).</li>
<li>When the counter resets.</li>
</ul>
<p>üìå <strong>Modes used in this lab:</strong></p>
<table><thead><tr><th>Mode</th><th>Description</th><th>Counter Behavior</th><th>Properties</th></tr></thead><tbody><tr><td><strong>Normal</strong></td><td><em>Starts at 0</em>        <em>Counts up to <code>0xFFFF</code></em></td><td><img decoding="async" loading="lazy" alt="Normal Mode" src="data:image/png;base64,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" width="1138" height="371" class="img_ev3q"></td><td><em>Fixed frequency based on clock &amp; prescaler</em></td></tr><tr><td><strong>CTC (Clear Timer on Compare)</strong></td><td><em>Starts at 0</em>        <em>Counts until reaching <code>OCRnA</code></em>        <em>Resets when threshold is met</em></td><td><img decoding="async" loading="lazy" alt="CTC Mode" src="data:image/png;base64,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" width="900" height="387" class="img_ev3q"></td><td><em>Variable frequency based on clock, prescaler &amp; compare value</em></td></tr></tbody></table>
<p><strong>Key Terms:</strong></p>
<ul>
<li><strong>BOTTOM</strong>: Minimum counting value (<code>0</code>).</li>
<li><strong>TOP</strong>: Maximum counting value.</li>
<li><strong>MAX</strong>: Highest possible value (255 for 8-bit, 65535 for 16-bit timers).<!-- -->
<ul>
<li><strong>TOP = MAX</strong> in <strong>Normal Mode</strong>.</li>
</ul>
</li>
</ul>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="23-timer-registers"><strong>2.3. Timer Registers</strong><a href="#23-timer-registers" class="hash-link" aria-label="Direct link to 23-timer-registers" title="Direct link to 23-timer-registers">‚Äã</a></h3>
<table><thead><tr><th>Timer</th><th>Registers</th><th>Description</th></tr></thead><tbody><tr><td><strong>Timer0 (8-bit)</strong></td><td><code>TCNT0</code></td><td>Counter register (holds current count value)</td></tr><tr><td></td><td><code>TCCR0A</code>, <code>TCCR0B</code></td><td>Control registers (configure the timer)</td></tr><tr><td></td><td><code>OCR0A</code>, <code>OCR0B</code></td><td>Compare registers (set interrupt thresholds)</td></tr><tr><td></td><td><code>TIMSK0</code>, <code>TIFR0</code></td><td>Registers for enabling/disabling interrupts &amp; status flags</td></tr><tr><td><strong>Timer1 (16-bit)</strong></td><td><code>TCNT1H/L</code></td><td>16-bit counter register</td></tr><tr><td></td><td><code>TCCR1A</code>, <code>TCCR1B</code>, <code>TCCR1C</code></td><td>Control registers</td></tr><tr><td></td><td><code>OCR1AH/L</code>, <code>OCR1BH/L</code></td><td>16-bit compare registers</td></tr><tr><td></td><td><code>TIMSK1</code>, <code>TIFR1</code></td><td>Interrupt &amp; flag registers</td></tr><tr><td></td><td><code>ICR1H/L</code></td><td>Input Capture Register - stores counter value on an external event</td></tr><tr><td><strong>Timer2 (8-bit)</strong></td><td><em>Same registers as Timer0</em></td><td>Timer2 supports an <strong>external clock</strong> via <code>TOSC1</code> &amp; <code>TOSC2</code></td></tr><tr><td></td><td><code>ASSR</code>, <code>GTCCR</code></td><td>Registers for asynchronous operation</td></tr></tbody></table>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p><strong>Interrupts must be globally enabled (bit <code>I</code> in <code>SREG</code> must be set).</strong><br>
<!-- -->Use <code>sei();</code> to enable global interrupts.</p></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="24-configuring-the-timer"><strong>2.4. Configuring the Timer</strong><a href="#24-configuring-the-timer" class="hash-link" aria-label="Direct link to 24-configuring-the-timer" title="Direct link to 24-configuring-the-timer">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="setting-the-timer-mode"><strong>Setting the Timer Mode</strong><a href="#setting-the-timer-mode" class="hash-link" aria-label="Direct link to setting-the-timer-mode" title="Direct link to setting-the-timer-mode">‚Äã</a></h3>
<p>To configure a timer mode:</p>
<ol>
<li>Set the <strong><code>WGM</code></strong> bits in the corresponding <strong>TCCRnA</strong> register.</li>
<li>Define the <strong>compare threshold</strong>.</li>
</ol>
<p><strong>Example: Set Timer0 in CTC Mode, counting to 5</strong></p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">TCCR0A </span><span class="token operator" style="color:#393A34">|=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> WGM01</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Set CTC Mode</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OCR0A </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">              </span><span class="token comment" style="color:#999988;font-style:italic">// Set compare threshold</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuring-the-prescaler"><strong>Configuring the Prescaler</strong><a href="#configuring-the-prescaler" class="hash-link" aria-label="Direct link to configuring-the-prescaler" title="Direct link to configuring-the-prescaler">‚Äã</a></h3>
<p>Prescaler values are set using <strong>CSx bits</strong> in <code>TCCRnB</code>.</p>
<p><strong>Example: Set Timer2 prescaler to 256</strong></p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">TCCR2B </span><span class="token operator" style="color:#393A34">|=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> CS22</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> CS21</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Set prescaler to 256</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="enabling-timer-interrupts"><strong>Enabling Timer Interrupts</strong><a href="#enabling-timer-interrupts" class="hash-link" aria-label="Direct link to enabling-timer-interrupts" title="Direct link to enabling-timer-interrupts">‚Äã</a></h3>
<p>To trigger an <strong>interrupt on compare match</strong>, enable the corresponding bit in <code>TIMSKx</code>.</p>
<p><strong>Example: Enable Compare Match A interrupt for Timer1</strong></p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;avr/interrupt.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">ISR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">TIMER1_COMPA_vect</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Timer1 Compare Match A Interrupt Handler</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">init_timer1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  TIMSK1 </span><span class="token operator" style="color:#393A34">|=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> OCIE1A</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Enable Timer1 Compare Match A Interrupt</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">sei</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">         </span><span class="token comment" style="color:#999988;font-style:italic">// Enable global interrupts</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">init_timer1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Initialize Timer1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Main loop</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="25-handling-16-bit-registers"><strong>2.5. Handling 16-bit Registers</strong><a href="#25-handling-16-bit-registers" class="hash-link" aria-label="Direct link to 25-handling-16-bit-registers" title="Direct link to 25-handling-16-bit-registers">‚Äã</a></h2>
<p>Some registers (<code>TCNT1</code>, <code>OCR1A/B</code>, <code>ICR1</code>) are <strong>16-bit</strong> but accessed <strong>8-bits at a time</strong>.</p>
<ul>
<li>Writing <strong>high byte first</strong> ensures atomic updates.</li>
</ul>
<p><strong>Example: Writing to <code>OCR1A</code> (16-bit register)</strong></p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">OCR1AH </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">threshold </span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Write high byte first</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OCR1AL </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> threshold</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Write low byte</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>This is <strong>automatically handled by the compiler</strong> in C when accessing registers <strong>without <code>H</code> or <code>L</code> suffix</strong>.</p></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="26-timer-calculator"><strong>2.6. Timer Calculator</strong><a href="#26-timer-calculator" class="hash-link" aria-label="Direct link to 26-timer-calculator" title="Direct link to 26-timer-calculator">‚Äã</a></h2>
<p>To configure a timer:</p>
<ul>
<li>Choose a <strong>prescaler</strong>.</li>
<li>Set a <strong>count limit</strong>.</li>
<li>Calculate values based on <strong>desired frequency</strong> and <strong>system clock</strong>.</li>
</ul>
<p><strong>Formula for Interrupt Frequency (<code>f_int</code>)</strong>:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">f_int = f_clk / (prescaler * (tc + 1))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Calculate Timer Count (<code>tc</code>)</strong>:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">tc = f_clk / (prescaler * f_int) - 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>üìå <strong>Example: Generating a 1Hz Timer Interrupt (Clock = 12MHz)</strong></p>
<table><thead><tr><th>Prescaler</th><th>Counter Limit (<code>tc</code>)</th><th>Timer1 (16-bit)</th><th>Timer0,2 (8-bit)</th><th>Notes</th></tr></thead><tbody><tr><td><strong>1</strong></td><td>11,999,999</td><td>‚ùå Invalid (16-bit overflow)</td><td>‚ùå Invalid (8-bit overflow)</td><td>Overflow</td></tr><tr><td><strong>8</strong></td><td>1,499,999</td><td>‚ùå Invalid</td><td>‚ùå Invalid</td><td>Overflow</td></tr><tr><td><strong>64</strong></td><td>187,499</td><td>‚ùå Invalid</td><td>‚ùå Invalid</td><td>Overflow</td></tr><tr><td><strong>256</strong></td><td>46,874</td><td>‚úÖ Valid (Use Timer1)</td><td>‚ùå Invalid</td><td><strong>Timer1 required</strong></td></tr><tr><td><strong>1024</strong></td><td>11,717</td><td>‚ùå Invalid</td><td>‚ùå Invalid</td><td><strong>Not exact/divisible</strong></td></tr></tbody></table>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p><strong>Timer2 supports prescalers of 32 and 128 (See ATmega324 Datasheet, Section 17.11.2, Page 160).</strong></p></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="useful-online-timer-calculators"><strong>Useful Online Timer Calculators</strong><a href="#useful-online-timer-calculators" class="hash-link" aria-label="Direct link to useful-online-timer-calculators" title="Direct link to useful-online-timer-calculators">‚Äã</a></h2>
<p>If you need <strong>precise register values</strong>, use these tools:</p>
<ul>
<li><strong>ATmega Timer/Counter/Prescaler Calculator</strong><br>
<a href="https://web.archive.org/web/20180312235028/https://et06.dunweber.com/atmega_timers/" target="_blank" rel="noopener noreferrer">ATmega Timer Calculator</a></li>
</ul>
<iframe src="https://web.archive.org/web/20180312235028/https://et06.dunweber.com/atmega_timers/" width="100%" height="500px"></iframe>
<ul>
<li><strong>Arduino Timer Interrupts Calculator</strong><br>
<a href="https://www.arduinoslovakia.eu/application/timer-calculator" target="_blank" rel="noopener noreferrer">AVR Timer Calculator</a></li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-exercises"><strong>3. Exercises</strong><a href="#3-exercises" class="hash-link" aria-label="Direct link to 3-exercises" title="Direct link to 3-exercises">‚Äã</a></h2>
<div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Lab Work</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Homework</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-11-implementing-millis"><strong>Task 1.1: Implementing <code>millis()</code></strong><a href="#task-11-implementing-millis" class="hash-link" aria-label="Direct link to task-11-implementing-millis" title="Direct link to task-11-implementing-millis">‚Äã</a></h3><ul>
<li>Implement a function similar to Arduino&#x27;s <code>millis()</code>, which returns the elapsed time since the microcontroller (¬µC) started or was last reset.</li>
<li>Configure <strong>USART0</strong> with the same parameters as in the previous lab.</li>
<li>Send a chosen message to the PC <strong>every 1 second</strong>.</li>
</ul><p>üìå <strong>Hints:</strong></p><ul>
<li>The <strong>¬µC clock frequency is 12MHz</strong>.</li>
<li>Use the <strong>formulas from the previous section</strong> to calculate the <strong>prescaler</strong> and <strong>compare register value</strong> for the timer.</li>
<li><strong>Timer2</strong> has more prescaler options, making it a good choice.</li>
</ul><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-12-button-debouncing"><strong>Task 1.2: Button Debouncing</strong><a href="#task-12-button-debouncing" class="hash-link" aria-label="Direct link to task-12-button-debouncing" title="Direct link to task-12-button-debouncing">‚Äã</a></h3><ul>
<li>A <strong>debounce method</strong> is required to properly detect <strong>short button presses</strong>.</li>
<li>How can <strong><code>millis()</code></strong> be used to eliminate false readings?</li>
<li><strong>Write a pseudocode function</strong> illustrating your solution.</li>
</ul><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-2-reimplementing-lab-0-exercise-3-using-timers--interrupts"><strong>Task 2: Reimplementing Lab 0 Exercise 3 Using Timers &amp; Interrupts</strong><a href="#task-2-reimplementing-lab-0-exercise-3-using-timers--interrupts" class="hash-link" aria-label="Direct link to task-2-reimplementing-lab-0-exercise-3-using-timers--interrupts" title="Direct link to task-2-reimplementing-lab-0-exercise-3-using-timers--interrupts">‚Äã</a></h3><ul>
<li><strong>Use timers &amp; interrupts</strong> to read button presses and <strong>control LED blinking</strong>.</li>
</ul><p>üìå <strong>Reminder (Lab 0, Exercise 3):</strong></p><ul>
<li><strong>BTN1:</strong> Cycles the <strong>RGB LED</strong> color (<strong>Red ‚Üí Green ‚Üí Blue ‚Üí Red</strong>).</li>
<li><strong>BTN2:</strong> Toggles <strong>LED blinking</strong>.</li>
</ul><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-3-controlling-a-buzzer-with-buttons"><strong>Task 3: Controlling a Buzzer with Buttons</strong><a href="#task-3-controlling-a-buzzer-with-buttons" class="hash-link" aria-label="Direct link to task-3-controlling-a-buzzer-with-buttons" title="Direct link to task-3-controlling-a-buzzer-with-buttons">‚Äã</a></h3><ul>
<li>Use <strong>buttons <code>PD6</code> and <code>PB2</code></strong> to control a buzzer.</li>
<li><strong>One button selects the frequency</strong> from three values (e.g., <strong>100Hz, 200Hz, 300Hz</strong>).</li>
<li><strong>The second button must be held down</strong> for the buzzer to produce sound.</li>
<li><strong>Use the RGB LED</strong> to indicate the selected frequency.</li>
</ul><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-4-bonus-timer-error-correction"><strong>Task 4 (BONUS): Timer Error Correction</strong><a href="#task-4-bonus-timer-error-correction" class="hash-link" aria-label="Direct link to task-4-bonus-timer-error-correction" title="Direct link to task-4-bonus-timer-error-correction">‚Äã</a></h3><ul>
<li>The <strong><code>millis()</code> function</strong> accumulates <strong>error</strong> over time due to clock frequency division inaccuracies.</li>
<li><strong>Calculate:</strong>
<ul>
<li>After how many timer cycles does the <strong>error exceed 1ms</strong>?</li>
</ul>
</li>
<li><strong>Propose a method</strong> to reduce this error.</li>
<li><strong>Implement the proposed correction method</strong>.</li>
</ul><hr></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p><strong>Use this</strong> <a href="https://www.tinkercad.com/things/kcBoaJMamLq-l02timerinterrupts?sharecode=0OTaTcQsxhidmfeSklLvesX5KHotedJvZVVPS4pSP_s" target="_blank" rel="noopener noreferrer"><strong>Tinkercad homework skeleton</strong></a> ‚ÜóÔ∏è</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-11-implementing-millis-1"><strong>Task 1.1: Implementing <code>millis()</code></strong><a href="#task-11-implementing-millis-1" class="hash-link" aria-label="Direct link to task-11-implementing-millis-1" title="Direct link to task-11-implementing-millis-1">‚Äã</a></h3><ul>
<li>Implement a function similar to Arduino&#x27;s <code>millis()</code>, which returns the elapsed time since the microcontroller (¬µC) started or was last reset.</li>
<li>Configure <strong>USART0</strong> with the same parameters as in the previous lab.</li>
<li>Send a chosen message to the PC <strong>every 1 second</strong>.</li>
</ul><p>üìå <strong>Hints:</strong></p><ul>
<li>The <strong>¬µC clock frequency is 12MHz</strong>.</li>
<li>Use the <strong>formulas from the previous section</strong> to calculate the <strong>prescaler</strong> and <strong>compare register value</strong> for the timer.</li>
<li><strong>Timer2</strong> has more prescaler options, making it a good choice.</li>
</ul><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-12-button-debouncing-1"><strong>Task 1.2: Button Debouncing</strong><a href="#task-12-button-debouncing-1" class="hash-link" aria-label="Direct link to task-12-button-debouncing-1" title="Direct link to task-12-button-debouncing-1">‚Äã</a></h3><ul>
<li>A <strong>debounce method</strong> is required to properly detect <strong>short button presses</strong>.</li>
<li>How can <strong><code>millis()</code></strong> be used to eliminate false readings?</li>
<li><strong>Write a pseudocode function</strong> illustrating your solution.</li>
</ul><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-2-reimplementing-lab-0-exercise-3-using-timers--interrupts-1"><strong>Task 2: Reimplementing Lab 0 Exercise 3 Using Timers &amp; Interrupts</strong><a href="#task-2-reimplementing-lab-0-exercise-3-using-timers--interrupts-1" class="hash-link" aria-label="Direct link to task-2-reimplementing-lab-0-exercise-3-using-timers--interrupts-1" title="Direct link to task-2-reimplementing-lab-0-exercise-3-using-timers--interrupts-1">‚Äã</a></h3><ul>
<li><strong>Use timers &amp; interrupts</strong> to read button presses and <strong>control LED blinking</strong>.</li>
</ul><p>üìå <strong>Reminder (Lab 0, Exercise 3):</strong></p><ul>
<li><strong>BTN1:</strong> Cycles the <strong>RGB LED</strong> color (<strong>Red ‚Üí Green ‚Üí Blue ‚Üí Red</strong>).</li>
<li><strong>BTN2:</strong> Toggles <strong>LED blinking</strong>.</li>
</ul><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-3-controlling-a-buzzer-with-buttons-1"><strong>Task 3: Controlling a Buzzer with Buttons</strong><a href="#task-3-controlling-a-buzzer-with-buttons-1" class="hash-link" aria-label="Direct link to task-3-controlling-a-buzzer-with-buttons-1" title="Direct link to task-3-controlling-a-buzzer-with-buttons-1">‚Äã</a></h3><ul>
<li>Use <strong>buttons <code>PD6</code> and <code>PB2</code></strong> to control a buzzer.</li>
<li><strong>One button selects the frequency</strong> from three values (e.g., <strong>100Hz, 200Hz, 300Hz</strong>).</li>
<li><strong>The second button must be held down</strong> for the buzzer to produce sound.</li>
<li><strong>Use the RGB LED</strong> to indicate the selected frequency.</li>
</ul><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-4-bonus-timer-error-correction-1"><strong>Task 4 (BONUS): Timer Error Correction</strong><a href="#task-4-bonus-timer-error-correction-1" class="hash-link" aria-label="Direct link to task-4-bonus-timer-error-correction-1" title="Direct link to task-4-bonus-timer-error-correction-1">‚Äã</a></h3><ul>
<li>The <strong><code>millis()</code> function</strong> accumulates <strong>error</strong> over time due to clock frequency division inaccuracies.</li>
<li><strong>Calculate:</strong>
<ul>
<li>After how many timer cycles does the <strong>error exceed 1ms</strong>?</li>
</ul>
</li>
<li><strong>Propose a method</strong> to reduce this error.</li>
<li><strong>Implement the proposed correction method</strong>.</li>
</ul><hr></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/lab/lab01"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Laboratory 1: USART. Debugging</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/lab/lab03"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Lab 3: Timers, Pulse Width Modulation (PWM)</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#useful-chapters-from-datasheet-atmega324" class="table-of-contents__link toc-highlight"><strong>Useful Chapters from</strong> Datasheet ATmega324</a></li><li><a href="#objective" class="table-of-contents__link toc-highlight"><strong>Objective</strong></a></li><li><a href="#1-interrupts" class="table-of-contents__link toc-highlight"><strong>1. Interrupts</strong></a><ul><li><a href="#why-use-interrupts" class="table-of-contents__link toc-highlight"><strong>Why Use Interrupts?</strong></a></li><li><a href="#handling-interrupts" class="table-of-contents__link toc-highlight"><strong>Handling Interrupts</strong></a></li></ul></li><li><a href="#interrupt-vector-table-ivt" class="table-of-contents__link toc-highlight"><strong>Interrupt Vector Table (IVT)</strong></a></li><li><a href="#interrupt-vector-table-for-atmega324" class="table-of-contents__link toc-highlight"><strong>Interrupt Vector Table for ATmega324</strong></a><ul><li><a href="#intn-interrupts" class="table-of-contents__link toc-highlight"><strong>INTn Interrupts</strong></a></li><li><a href="#pcintn-interrupts" class="table-of-contents__link toc-highlight"><strong>PCINTn Interrupts</strong></a></li></ul></li><li><a href="#external-interrupt-pins-on-atmega324" class="table-of-contents__link toc-highlight"><strong>External Interrupt Pins on ATmega324</strong></a></li><li><a href="#11-using-interrupts" class="table-of-contents__link toc-highlight"><strong>1.1. Using Interrupts</strong></a><ul><li><a href="#1Ô∏è‚É£-enable-the-global-interrupt-mechanism" class="table-of-contents__link toc-highlight"><strong>1Ô∏è‚É£ Enable the global interrupt mechanism</strong></a></li><li><a href="#2Ô∏è‚É£-configure-the-peripheral-that-will-generate-interrupts" class="table-of-contents__link toc-highlight"><strong>2Ô∏è‚É£ Configure the peripheral that will generate interrupts</strong></a></li><li><a href="#eicra-register" class="table-of-contents__link toc-highlight"><strong>EICRA Register</strong></a></li><li><a href="#interrupt-trigger-modes" class="table-of-contents__link toc-highlight"><strong>Interrupt Trigger Modes</strong></a></li><li><a href="#3Ô∏è‚É£-implement-the-interrupt-service-routine-isr" class="table-of-contents__link toc-highlight"><strong>3Ô∏è‚É£ Implement the Interrupt Service Routine (ISR)</strong></a></li></ul></li><li><a href="#enabling-interrupts-and-testing-the-program" class="table-of-contents__link toc-highlight"><strong>Enabling Interrupts and Testing the Program</strong></a><ul><li><a href="#status-register-sreg" class="table-of-contents__link toc-highlight"><strong>Status Register (SREG)</strong></a></li><li><a href="#mcu-control-register-mcucr" class="table-of-contents__link toc-highlight"><strong>MCU Control Register (MCUCR)</strong></a></li><li><a href="#external-interrupt-mask-register-eimsk" class="table-of-contents__link toc-highlight"><strong>External Interrupt Mask Register (EIMSK)</strong></a></li></ul></li><li><a href="#12-using-interrupts-in-avr-gcc" class="table-of-contents__link toc-highlight"><strong>1.2 Using Interrupts in avr-gcc</strong></a><ul><li><a href="#common-interrupt-vectors" class="table-of-contents__link toc-highlight"><strong>Common Interrupt Vectors</strong></a></li><li><a href="#defining-an-isr" class="table-of-contents__link toc-highlight"><strong>Defining an ISR</strong></a></li><li><a href="#interrupt-handling-rules" class="table-of-contents__link toc-highlight"><strong>Interrupt Handling Rules</strong></a></li><li><a href="#isr-flags" class="table-of-contents__link toc-highlight"><strong>ISR Flags</strong></a></li><li><a href="#additional-helper-functions" class="table-of-contents__link toc-highlight"><strong>Additional Helper Functions</strong></a></li></ul></li><li><a href="#2-timer" class="table-of-contents__link toc-highlight"><strong>2. Timer</strong></a><ul><li><a href="#21-how-a-timer-works" class="table-of-contents__link toc-highlight"><strong>2.1. How a Timer Works</strong></a></li><li><a href="#basic-timer-components-in-atmega324" class="table-of-contents__link toc-highlight"><strong>Basic Timer Components in ATmega324</strong></a></li><li><a href="#22-timer-operating-modes" class="table-of-contents__link toc-highlight"><strong>2.2. Timer Operating Modes</strong></a></li><li><a href="#23-timer-registers" class="table-of-contents__link toc-highlight"><strong>2.3. Timer Registers</strong></a></li></ul></li><li><a href="#24-configuring-the-timer" class="table-of-contents__link toc-highlight"><strong>2.4. Configuring the Timer</strong></a><ul><li><a href="#setting-the-timer-mode" class="table-of-contents__link toc-highlight"><strong>Setting the Timer Mode</strong></a></li><li><a href="#configuring-the-prescaler" class="table-of-contents__link toc-highlight"><strong>Configuring the Prescaler</strong></a></li><li><a href="#enabling-timer-interrupts" class="table-of-contents__link toc-highlight"><strong>Enabling Timer Interrupts</strong></a></li></ul></li><li><a href="#25-handling-16-bit-registers" class="table-of-contents__link toc-highlight"><strong>2.5. Handling 16-bit Registers</strong></a></li><li><a href="#26-timer-calculator" class="table-of-contents__link toc-highlight"><strong>2.6. Timer Calculator</strong></a></li><li><a href="#useful-online-timer-calculators" class="table-of-contents__link toc-highlight"><strong>Useful Online Timer Calculators</strong></a></li><li><a href="#3-exercises" class="table-of-contents__link toc-highlight"><strong>3. Exercises</strong></a><ul><li><a href="#task-11-implementing-millis" class="table-of-contents__link toc-highlight"><strong>Task 1.1: Implementing <code>millis()</code></strong></a></li><li><a href="#task-12-button-debouncing" class="table-of-contents__link toc-highlight"><strong>Task 1.2: Button Debouncing</strong></a></li><li><a href="#task-2-reimplementing-lab-0-exercise-3-using-timers--interrupts" class="table-of-contents__link toc-highlight"><strong>Task 2: Reimplementing Lab 0 Exercise 3 Using Timers &amp; Interrupts</strong></a></li><li><a href="#task-3-controlling-a-buzzer-with-buttons" class="table-of-contents__link toc-highlight"><strong>Task 3: Controlling a Buzzer with Buttons</strong></a></li><li><a href="#task-4-bonus-timer-error-correction" class="table-of-contents__link toc-highlight"><strong>Task 4 (BONUS): Timer Error Correction</strong></a></li><li><a href="#task-11-implementing-millis-1" class="table-of-contents__link toc-highlight"><strong>Task 1.1: Implementing <code>millis()</code></strong></a></li><li><a href="#task-12-button-debouncing-1" class="table-of-contents__link toc-highlight"><strong>Task 1.2: Button Debouncing</strong></a></li><li><a href="#task-2-reimplementing-lab-0-exercise-3-using-timers--interrupts-1" class="table-of-contents__link toc-highlight"><strong>Task 2: Reimplementing Lab 0 Exercise 3 Using Timers &amp; Interrupts</strong></a></li><li><a href="#task-3-controlling-a-buzzer-with-buttons-1" class="table-of-contents__link toc-highlight"><strong>Task 3: Controlling a Buzzer with Buttons</strong></a></li><li><a href="#task-4-bonus-timer-error-correction-1" class="table-of-contents__link toc-highlight"><strong>Task 4 (BONUS): Timer Error Correction</strong></a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://ocw.cs.pub.ro/courses/pm" target="_blank" rel="noopener noreferrer" class="footer__link-item">UPB Open CourseWare <svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2025 Politehnica Bucharest. <br> This pages are the translated and adapted version from https://ocw.cs.pub.ro/courses/pm</div></div></div></footer></div>
</body>
</html>