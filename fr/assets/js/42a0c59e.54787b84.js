"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[724],{669:(e,s,n)=>{n.d(s,{A:()=>l});const l=n.p+"assets/images/hue-wheel-c49e6582240e8af2ccba3fa0b5d56475.png"},760:(e,s,n)=>{n.d(s,{A:()=>l});const l=n.p+"assets/images/pwm_led-99e7e25dfc8515e2e21b4990787538d0.gif"},2942:(e,s,n)=>{n.d(s,{A:()=>l});const l=n.p+"assets/images/phase_correct_pwm-0813510f0ec626ea0e4a3968225159b6.png"},3205:(e,s,n)=>{n.d(s,{A:()=>a});n(6540);var l=n(7481),r=n(3092),i=n(4848);const a=e=>{let{left:s,right:n}=e;return(0,i.jsxs)("div",{style:{display:"flex",gap:"20px",alignItems:"flex-start"},children:[(0,i.jsxs)("div",{style:{flex:1},children:[(0,i.jsx)(l.o,{remarkPlugins:[r.A],children:s})," "]}),(0,i.jsxs)("div",{style:{flex:1},children:[(0,i.jsx)(l.o,{remarkPlugins:[r.A],children:n})," "]})]})}},5537:(e,s,n)=>{n.d(s,{A:()=>y});var l=n(6540),r=n(4164),i=n(5627),a=n(6347),t=n(372),c=n(604),d=n(1861),o=n(8749);function m(e){return l.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,l.isValidElement)(e)&&function(e){const{props:s}=e;return!!s&&"object"==typeof s&&"value"in s}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:s,children:n}=e;return(0,l.useMemo)((()=>{const e=s??function(e){return m(e).map((e=>{let{props:{value:s,label:n,attributes:l,default:r}}=e;return{value:s,label:n,attributes:l,default:r}}))}(n);return function(e){const s=(0,d.XI)(e,((e,s)=>e.value===s.value));if(s.length>0)throw new Error(`Docusaurus error: Duplicate values "${s.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[s,n])}function u(e){let{value:s,tabValues:n}=e;return n.some((e=>e.value===s))}function x(e){let{queryString:s=!1,groupId:n}=e;const r=(0,a.W6)(),i=function(e){let{queryString:s=!1,groupId:n}=e;if("string"==typeof s)return s;if(!1===s)return null;if(!0===s&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:s,groupId:n});return[(0,c.aZ)(i),(0,l.useCallback)((e=>{if(!i)return;const s=new URLSearchParams(r.location.search);s.set(i,e),r.replace({...r.location,search:s.toString()})}),[i,r])]}function p(e){const{defaultValue:s,queryString:n=!1,groupId:r}=e,i=h(e),[a,c]=(0,l.useState)((()=>function(e){let{defaultValue:s,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(s){if(!u({value:s,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${s}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return s}const l=n.find((e=>e.default))??n[0];if(!l)throw new Error("Unexpected error: 0 tabValues");return l.value}({defaultValue:s,tabValues:i}))),[d,m]=x({queryString:n,groupId:r}),[p,j]=function(e){let{groupId:s}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(s),[r,i]=(0,o.Dv)(n);return[r,(0,l.useCallback)((e=>{n&&i.set(e)}),[n,i])]}({groupId:r}),g=(()=>{const e=d??p;return u({value:e,tabValues:i})?e:null})();(0,t.A)((()=>{g&&c(g)}),[g]);return{selectedValue:a,selectValue:(0,l.useCallback)((e=>{if(!u({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);c(e),m(e),j(e)}),[m,j,i]),tabValues:i}}var j=n(9136);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var v=n(4848);function f(e){let{className:s,block:n,selectedValue:l,selectValue:a,tabValues:t}=e;const c=[],{blockElementScrollPositionUntilNextRender:d}=(0,i.a_)(),o=e=>{const s=e.currentTarget,n=c.indexOf(s),r=t[n].value;r!==l&&(d(s),a(r))},m=e=>{let s=null;switch(e.key){case"Enter":o(e);break;case"ArrowRight":{const n=c.indexOf(e.currentTarget)+1;s=c[n]??c[0];break}case"ArrowLeft":{const n=c.indexOf(e.currentTarget)-1;s=c[n]??c[c.length-1];break}}s?.focus()};return(0,v.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":n},s),children:t.map((e=>{let{value:s,label:n,attributes:i}=e;return(0,v.jsx)("li",{role:"tab",tabIndex:l===s?0:-1,"aria-selected":l===s,ref:e=>{c.push(e)},onKeyDown:m,onClick:o,...i,className:(0,r.A)("tabs__item",g.tabItem,i?.className,{"tabs__item--active":l===s}),children:n??s},s)}))})}function b(e){let{lazy:s,children:n,selectedValue:i}=e;const a=(Array.isArray(n)?n:[n]).filter(Boolean);if(s){const e=a.find((e=>e.props.value===i));return e?(0,l.cloneElement)(e,{className:(0,r.A)("margin-top--md",e.props.className)}):null}return(0,v.jsx)("div",{className:"margin-top--md",children:a.map(((e,s)=>(0,l.cloneElement)(e,{key:s,hidden:e.props.value!==i})))})}function N(e){const s=p(e);return(0,v.jsxs)("div",{className:(0,r.A)("tabs-container",g.tabList),children:[(0,v.jsx)(f,{...s,...e}),(0,v.jsx)(b,{...s,...e})]})}function y(e){const s=(0,j.A)();return(0,v.jsx)(N,{...e,children:m(e.children)},String(s))}},5595:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>t,default:()=>m,frontMatter:()=>a,metadata:()=>l,toc:()=>d});const l=JSON.parse('{"id":"lab03/index","title":"TP 3 : Timers, Modulation de Largeur d\'Impulsion (PWM)","description":"Chapitres utiles du Datasheet ATmega324P","source":"@site/i18n/fr/docusaurus-plugin-content-docs-lab/current/lab03/index.mdx","sourceDirName":"lab03","slug":"/lab03/","permalink":"/fr/lab/lab03/","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"labSidebar","previous":{"title":"Laboratoire 2 : Interruptions, Timers","permalink":"/fr/lab/lab02/"},"next":{"title":"Lab 4: Analog to Digital Converter (ADC)","permalink":"/fr/lab/lab04/"}}');var r=n(4848),i=n(8453);n(3205),n(7003),n(7272),n(5537),n(9329);const a={sidebar_position:5},t="TP 3 : Timers, Modulation de Largeur d'Impulsion (PWM)",c={},d=[{value:"1. Modulation de Largeur d&#39;Impulsion (PWM)",id:"1-modulation-de-largeur-dimpulsion-pwm",level:2},{value:"1.1. Principe de fonctionnement",id:"11-principe-de-fonctionnement",level:3},{value:"2. PWM sur les Microcontr\xf4leurs AVR",id:"2-pwm-sur-les-microcontr\xf4leurs-avr",level:2},{value:"Fast PWM",id:"fast-pwm",level:3},{value:"Exemple : Timer1 en Fast PWM 8 bits, mode non-invers\xe9 avec pr\xe9diviseur de 1024",id:"exemple--timer1-en-fast-pwm-8-bits-mode-non-invers\xe9-avec-pr\xe9diviseur-de-1024",level:4},{value:"Phase Correct PWM",id:"phase-correct-pwm",level:3},{value:"Comparaison : Fast PWM vs Phase Correct PWM",id:"comparaison--fast-pwm-vs-phase-correct-pwm",level:3},{value:"3. Exercices",id:"3-exercices",level:2},{value:"T\xe2che 0",id:"t\xe2che-0",level:3},{value:"T\xe2che 1",id:"t\xe2che-1",level:3},{value:"T\xe2che 2",id:"t\xe2che-2",level:3},{value:"T\xe2che 3",id:"t\xe2che-3",level:3},{value:"T\xe2che 4 (Bonus)",id:"t\xe2che-4-bonus",level:3},{value:"Bonus 2",id:"bonus-2",level:3},{value:"4. Liens Utiles",id:"4-liens-utiles",level:2}];function o(e){const s={a:"a",admonition:"admonition",annotation:"annotation",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",img:"img",li:"li",math:"math",mfrac:"mfrac",mi:"mi",mn:"mn",mo:"mo",mover:"mover",mrow:"mrow",msub:"msub",ol:"ol",p:"p",pre:"pre",semantics:"semantics",span:"span",strong:"strong",ul:"ul",...(0,i.R)(),...e.components},{Details:l}=s;return l||function(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"tp-3--timers-modulation-de-largeur-dimpulsion-pwm",children:"TP 3 : Timers, Modulation de Largeur d'Impulsion (PWM)"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsxs)(s.strong,{children:["Chapitres utiles du ",(0,r.jsx)(s.a,{href:"https://ww1.microchip.com/downloads/en/DeviceDoc/Atmel-42743-ATmega324P_Datasheet.pdf",children:"Datasheet ATmega324P"})]})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsx)(s.li,{children:"Configuration des broches \u2013 section 1.1, page 15"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.ol,{start:"16",children:["\n",(0,r.jsx)(s.li,{children:"Timer/Compteur 8 bits 0 avec PWM \u2013 section 16.9, page 140"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.ol,{start:"17",children:["\n",(0,r.jsx)(s.li,{children:"Timer/Compteur 16 bits 1 avec PWM \u2013 section 17.14, page 173"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.ol,{start:"19",children:["\n",(0,r.jsx)(s.li,{children:"Timer/Compteur 8 bits 2 avec PWM et fonctionnement asynchrone \u2013 section 19.11, page 202"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"1-modulation-de-largeur-dimpulsion-pwm",children:"1. Modulation de Largeur d'Impulsion (PWM)"}),"\n",(0,r.jsxs)(s.p,{children:["La ",(0,r.jsx)(s.strong,{children:"PWM"})," (Pulse Width Modulation) est une technique permettant de contr\xf4ler la tension appliqu\xe9e \xe0 un dispositif \xe9lectronique en le commutant rapidement entre les \xe9tats ",(0,r.jsx)(s.strong,{children:"ON"})," et ",(0,r.jsx)(s.strong,{children:"OFF"}),"."]}),"\n",(0,r.jsxs)(s.p,{children:["Ce basculement rapide g\xe9n\xe8re une ",(0,r.jsx)(s.strong,{children:"tension moyenne"})," d\xe9termin\xe9e par le temps pendant lequel le signal reste \xe0 l'\xe9tat ON par rapport au temps total du cycle \u2014 ce rapport s'appelle le ",(0,r.jsx)(s.strong,{children:"cycle de travail"})," (",(0,r.jsx)(s.em,{children:"duty cycle"}),")."]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"Principe PWM",src:n(8325).A+"",width:"561",height:"210"})}),"\n",(0,r.jsxs)(s.p,{children:["La PWM permet un ",(0,r.jsx)(s.strong,{children:"contr\xf4le num\xe9rique"})," de ",(0,r.jsx)(s.strong,{children:"signaux analogiques"}),", par exemple :"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Variation de l'intensit\xe9 d'une LED"}),"\n",(0,r.jsx)(s.li,{children:"Changement de couleur des LEDs RGB"}),"\n",(0,r.jsx)(s.li,{children:"R\xe9glage de la fr\xe9quence d\u2019un buzzer"}),"\n",(0,r.jsx)(s.li,{children:"Contr\xf4le de la vitesse d\u2019un moteur"}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"Contr\xf4le LED par PWM",src:n(760).A+"",width:"1200",height:"600"})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"11-principe-de-fonctionnement",children:"1.1. Principe de fonctionnement"}),"\n",(0,r.jsx)(s.p,{children:"Le cycle de travail s\u2019exprime en pourcentage du temps ON par rapport au cycle total :"}),"\n",(0,r.jsx)(s.span,{className:"katex-display",children:(0,r.jsxs)(s.span,{className:"katex",children:[(0,r.jsx)(s.span,{className:"katex-mathml",children:(0,r.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,r.jsxs)(s.semantics,{children:[(0,r.jsxs)(s.mrow,{children:[(0,r.jsx)(s.mi,{children:"D"}),(0,r.jsx)(s.mo,{stretchy:"false",children:"["}),(0,r.jsx)(s.mi,{mathvariant:"normal",children:"%"}),(0,r.jsx)(s.mo,{stretchy:"false",children:"]"}),(0,r.jsx)(s.mo,{children:"="}),(0,r.jsxs)(s.mfrac,{children:[(0,r.jsxs)(s.msub,{children:[(0,r.jsx)(s.mi,{children:"t"}),(0,r.jsxs)(s.mrow,{children:[(0,r.jsx)(s.mi,{children:"o"}),(0,r.jsx)(s.mi,{children:"n"})]})]}),(0,r.jsxs)(s.mrow,{children:[(0,r.jsxs)(s.msub,{children:[(0,r.jsx)(s.mi,{children:"t"}),(0,r.jsxs)(s.mrow,{children:[(0,r.jsx)(s.mi,{children:"o"}),(0,r.jsx)(s.mi,{children:"n"})]})]}),(0,r.jsx)(s.mo,{children:"+"}),(0,r.jsxs)(s.msub,{children:[(0,r.jsx)(s.mi,{children:"t"}),(0,r.jsxs)(s.mrow,{children:[(0,r.jsx)(s.mi,{children:"o"}),(0,r.jsx)(s.mi,{children:"f"}),(0,r.jsx)(s.mi,{children:"f"})]})]})]})]}),(0,r.jsx)(s.mo,{children:"\u22c5"}),(0,r.jsx)(s.mn,{children:"100"}),(0,r.jsx)(s.mo,{children:"="}),(0,r.jsxs)(s.mfrac,{children:[(0,r.jsxs)(s.mrow,{children:[(0,r.jsx)(s.mi,{children:"p"}),(0,r.jsx)(s.mi,{children:"u"}),(0,r.jsx)(s.mi,{children:"l"}),(0,r.jsx)(s.mi,{children:"s"}),(0,r.jsx)(s.mi,{children:"e"}),(0,r.jsx)(s.mi,{mathvariant:"normal",children:"_"}),(0,r.jsx)(s.mi,{children:"w"}),(0,r.jsx)(s.mi,{children:"i"}),(0,r.jsx)(s.mi,{children:"d"}),(0,r.jsx)(s.mi,{children:"t"}),(0,r.jsx)(s.mi,{children:"h"})]}),(0,r.jsxs)(s.mrow,{children:[(0,r.jsx)(s.mi,{children:"p"}),(0,r.jsx)(s.mi,{children:"e"}),(0,r.jsx)(s.mi,{children:"r"}),(0,r.jsx)(s.mi,{children:"i"}),(0,r.jsx)(s.mi,{children:"o"}),(0,r.jsx)(s.mi,{children:"d"})]})]}),(0,r.jsx)(s.mo,{children:"\u22c5"}),(0,r.jsx)(s.mn,{children:"100"})]}),(0,r.jsx)(s.annotation,{encoding:"application/x-tex",children:"D[\\%] = \\frac{t_{on}}{t_{on} + t_{off}} \\cdot 100 = \\frac{pulse\\_width}{period} \\cdot 100"})]})})}),(0,r.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,r.jsxs)(s.span,{className:"base",children:[(0,r.jsx)(s.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,r.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"D"}),(0,r.jsx)(s.span,{className:"mopen",children:"["}),(0,r.jsx)(s.span,{className:"mord",children:"%"}),(0,r.jsx)(s.span,{className:"mclose",children:"]"}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,r.jsx)(s.span,{className:"mrel",children:"="}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,r.jsxs)(s.span,{className:"base",children:[(0,r.jsx)(s.span,{className:"strut",style:{height:"2.2642em",verticalAlign:"-0.9721em"}}),(0,r.jsxs)(s.span,{className:"mord",children:[(0,r.jsx)(s.span,{className:"mopen nulldelimiter"}),(0,r.jsx)(s.span,{className:"mfrac",children:(0,r.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,r.jsxs)(s.span,{className:"vlist-r",children:[(0,r.jsxs)(s.span,{className:"vlist",style:{height:"1.2921em"},children:[(0,r.jsxs)(s.span,{style:{top:"-2.314em"},children:[(0,r.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,r.jsxs)(s.span,{className:"mord",children:[(0,r.jsxs)(s.span,{className:"mord",children:[(0,r.jsx)(s.span,{className:"mord mathnormal",children:"t"}),(0,r.jsx)(s.span,{className:"msupsub",children:(0,r.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,r.jsxs)(s.span,{className:"vlist-r",children:[(0,r.jsx)(s.span,{className:"vlist",style:{height:"0.1514em"},children:(0,r.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,r.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,r.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,r.jsxs)(s.span,{className:"mord mtight",children:[(0,r.jsx)(s.span,{className:"mord mathnormal mtight",children:"o"}),(0,r.jsx)(s.span,{className:"mord mathnormal mtight",children:"n"})]})})]})}),(0,r.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,r.jsx)(s.span,{className:"vlist-r",children:(0,r.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,r.jsx)(s.span,{})})})]})})]}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,r.jsx)(s.span,{className:"mbin",children:"+"}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,r.jsxs)(s.span,{className:"mord",children:[(0,r.jsx)(s.span,{className:"mord mathnormal",children:"t"}),(0,r.jsx)(s.span,{className:"msupsub",children:(0,r.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,r.jsxs)(s.span,{className:"vlist-r",children:[(0,r.jsx)(s.span,{className:"vlist",style:{height:"0.3361em"},children:(0,r.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,r.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,r.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,r.jsxs)(s.span,{className:"mord mtight",children:[(0,r.jsx)(s.span,{className:"mord mathnormal mtight",children:"o"}),(0,r.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.10764em"},children:"ff"})]})})]})}),(0,r.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,r.jsx)(s.span,{className:"vlist-r",children:(0,r.jsx)(s.span,{className:"vlist",style:{height:"0.2861em"},children:(0,r.jsx)(s.span,{})})})]})})]})]})]}),(0,r.jsxs)(s.span,{style:{top:"-3.23em"},children:[(0,r.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,r.jsx)(s.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,r.jsxs)(s.span,{style:{top:"-3.677em"},children:[(0,r.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,r.jsx)(s.span,{className:"mord",children:(0,r.jsxs)(s.span,{className:"mord",children:[(0,r.jsx)(s.span,{className:"mord mathnormal",children:"t"}),(0,r.jsx)(s.span,{className:"msupsub",children:(0,r.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,r.jsxs)(s.span,{className:"vlist-r",children:[(0,r.jsx)(s.span,{className:"vlist",style:{height:"0.1514em"},children:(0,r.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,r.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,r.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,r.jsxs)(s.span,{className:"mord mtight",children:[(0,r.jsx)(s.span,{className:"mord mathnormal mtight",children:"o"}),(0,r.jsx)(s.span,{className:"mord mathnormal mtight",children:"n"})]})})]})}),(0,r.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,r.jsx)(s.span,{className:"vlist-r",children:(0,r.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,r.jsx)(s.span,{})})})]})})]})})]})]}),(0,r.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,r.jsx)(s.span,{className:"vlist-r",children:(0,r.jsx)(s.span,{className:"vlist",style:{height:"0.9721em"},children:(0,r.jsx)(s.span,{})})})]})}),(0,r.jsx)(s.span,{className:"mclose nulldelimiter"})]}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,r.jsx)(s.span,{className:"mbin",children:"\u22c5"}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,r.jsxs)(s.span,{className:"base",children:[(0,r.jsx)(s.span,{className:"strut",style:{height:"0.6444em"}}),(0,r.jsx)(s.span,{className:"mord",children:"100"}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,r.jsx)(s.span,{className:"mrel",children:"="}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,r.jsxs)(s.span,{className:"base",children:[(0,r.jsx)(s.span,{className:"strut",style:{height:"2.2749em",verticalAlign:"-0.8804em"}}),(0,r.jsxs)(s.span,{className:"mord",children:[(0,r.jsx)(s.span,{className:"mopen nulldelimiter"}),(0,r.jsx)(s.span,{className:"mfrac",children:(0,r.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,r.jsxs)(s.span,{className:"vlist-r",children:[(0,r.jsxs)(s.span,{className:"vlist",style:{height:"1.3944em"},children:[(0,r.jsxs)(s.span,{style:{top:"-2.314em"},children:[(0,r.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,r.jsxs)(s.span,{className:"mord",children:[(0,r.jsx)(s.span,{className:"mord mathnormal",children:"p"}),(0,r.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"er"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"i"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"o"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"d"})]})]}),(0,r.jsxs)(s.span,{style:{top:"-3.23em"},children:[(0,r.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,r.jsx)(s.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,r.jsxs)(s.span,{style:{top:"-3.7em"},children:[(0,r.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,r.jsxs)(s.span,{className:"mord",children:[(0,r.jsx)(s.span,{className:"mord mathnormal",children:"p"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"u"}),(0,r.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.01968em"},children:"l"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"se"}),(0,r.jsx)(s.span,{className:"mord",style:{marginRight:"0.02778em"},children:"_"}),(0,r.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.02691em"},children:"w"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"i"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"d"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"t"}),(0,r.jsx)(s.span,{className:"mord mathnormal",children:"h"})]})]})]}),(0,r.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,r.jsx)(s.span,{className:"vlist-r",children:(0,r.jsx)(s.span,{className:"vlist",style:{height:"0.8804em"},children:(0,r.jsx)(s.span,{})})})]})}),(0,r.jsx)(s.span,{className:"mclose nulldelimiter"})]}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,r.jsx)(s.span,{className:"mbin",children:"\u22c5"}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,r.jsxs)(s.span,{className:"base",children:[(0,r.jsx)(s.span,{className:"strut",style:{height:"0.6444em"}}),(0,r.jsx)(s.span,{className:"mord",children:"100"})]})]})]})}),"\n",(0,r.jsxs)(s.p,{children:["La ",(0,r.jsx)(s.strong,{children:"tension moyenne"})," re\xe7ue par un dispositif est :"]}),"\n",(0,r.jsx)(s.span,{className:"katex-display",children:(0,r.jsxs)(s.span,{className:"katex",children:[(0,r.jsx)(s.span,{className:"katex-mathml",children:(0,r.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,r.jsxs)(s.semantics,{children:[(0,r.jsxs)(s.mrow,{children:[(0,r.jsxs)(s.mover,{accent:"true",children:[(0,r.jsx)(s.mi,{children:"V"}),(0,r.jsx)(s.mo,{children:"\u02c9"})]}),(0,r.jsx)(s.mo,{children:"="}),(0,r.jsx)(s.mi,{children:"D"}),(0,r.jsx)(s.mo,{children:"\u22c5"}),(0,r.jsxs)(s.msub,{children:[(0,r.jsx)(s.mi,{children:"V"}),(0,r.jsxs)(s.mrow,{children:[(0,r.jsx)(s.mi,{children:"c"}),(0,r.jsx)(s.mi,{children:"c"})]})]})]}),(0,r.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\bar{V} = D \\cdot V_{cc}"})]})})}),(0,r.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,r.jsxs)(s.span,{className:"base",children:[(0,r.jsx)(s.span,{className:"strut",style:{height:"0.8201em"}}),(0,r.jsx)(s.span,{className:"mord accent",children:(0,r.jsx)(s.span,{className:"vlist-t",children:(0,r.jsx)(s.span,{className:"vlist-r",children:(0,r.jsxs)(s.span,{className:"vlist",style:{height:"0.8201em"},children:[(0,r.jsxs)(s.span,{style:{top:"-3em"},children:[(0,r.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,r.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.22222em"},children:"V"})]}),(0,r.jsxs)(s.span,{style:{top:"-3.2523em"},children:[(0,r.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,r.jsx)(s.span,{className:"accent-body",style:{left:"-0.25em"},children:(0,r.jsx)(s.span,{className:"mord",children:"\u02c9"})})]})]})})})}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,r.jsx)(s.span,{className:"mrel",children:"="}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,r.jsxs)(s.span,{className:"base",children:[(0,r.jsx)(s.span,{className:"strut",style:{height:"0.6833em"}}),(0,r.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"D"}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,r.jsx)(s.span,{className:"mbin",children:"\u22c5"}),(0,r.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,r.jsxs)(s.span,{className:"base",children:[(0,r.jsx)(s.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,r.jsxs)(s.span,{className:"mord",children:[(0,r.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.22222em"},children:"V"}),(0,r.jsx)(s.span,{className:"msupsub",children:(0,r.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,r.jsxs)(s.span,{className:"vlist-r",children:[(0,r.jsx)(s.span,{className:"vlist",style:{height:"0.1514em"},children:(0,r.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.2222em",marginRight:"0.05em"},children:[(0,r.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,r.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,r.jsx)(s.span,{className:"mord mtight",children:(0,r.jsx)(s.span,{className:"mord mathnormal mtight",children:"cc"})})})]})}),(0,r.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,r.jsx)(s.span,{className:"vlist-r",children:(0,r.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,r.jsx)(s.span,{})})})]})})]})]})]})]})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"Signaux PWM avec diff\xe9rents cycles de travail",src:n(7969).A+"",width:"987",height:"237"})}),"\n",(0,r.jsxs)(s.p,{children:["Les signaux PWM sont g\xe9n\xe9ralement g\xe9n\xe9r\xe9s par des circuits num\xe9riques et des microcontr\xf4leurs. L\u2019ATmega324 utilise un ",(0,r.jsx)(s.strong,{children:"compteur"})," qui se r\xe9initialise p\xe9riodiquement et compare sa valeur avec une r\xe9f\xe9rence (",(0,r.jsx)(s.code,{children:"OCRn"}),"). Lorsque le compteur d\xe9passe la valeur de r\xe9f\xe9rence, la sortie PWM change d\u2019\xe9tat."]}),"\n",(0,r.jsxs)(l,{children:[(0,r.jsx)("summary",{children:"\ud83d\udee0\ufe0f PWM par logiciel ?"}),(0,r.jsx)(s.p,{children:"La PWM peut \xe9galement \xeatre impl\xe9ment\xe9e en logiciel avec des m\xe9thodes comme :"}),(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Bit-banging"}),"\n",(0,r.jsx)(s.li,{children:"Timers avec routines d\u2019interruption (ISR)"}),"\n"]}),(0,r.jsxs)(s.p,{children:["Mais pour une PWM \xe0 ",(0,r.jsx)(s.strong,{children:"haute fr\xe9quence"})," (par exemple, dans les kHz pour les moteurs), la ",(0,r.jsx)(s.strong,{children:"PWM mat\xe9rielle"})," est bien plus efficace, car elle \xe9vite la surcharge du CPU caus\xe9e par des interruptions fr\xe9quentes."]})]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"2-pwm-sur-les-microcontr\xf4leurs-avr",children:"2. PWM sur les Microcontr\xf4leurs AVR"}),"\n",(0,r.jsx)(s.p,{children:"Dans le laboratoire pr\xe9c\xe9dent, nous avons vu que l\u2019ATmega324 poss\xe8de trois timers :"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"Timer0"})," (8 bits)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"Timer1"})," (16 bits)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"Timer2"})," (8 bits)"]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["Chaque timer peut \xeatre configur\xe9 via les registres de contr\xf4le ",(0,r.jsx)(s.code,{children:"TCCRnA"})," et ",(0,r.jsx)(s.code,{children:"TCCRnB"}),", en utilisant les bits ",(0,r.jsx)(s.code,{children:"WGMnx"})," pour s\xe9lectionner le mode :"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.strong,{children:"Normal"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.strong,{children:"CTC (Clear Timer on Compare Match)"})}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Fast PWM"})," (utilis\xe9 aujourd\u2019hui !)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Phase Correct PWM"}),", etc."]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["Chaque timer dispose de deux canaux de comparaison de sortie : ",(0,r.jsx)(s.code,{children:"OCnA"})," et ",(0,r.jsx)(s.code,{children:"OCnB"}),". Ceux-ci sont li\xe9s \xe0 des broches physiques sp\xe9cifiques. Consultez le chapitre ",(0,r.jsx)(s.strong,{children:"Pin Configurations"})," de la fiche technique pour les correspondances exactes :"]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"Broches de sortie PWM sur ATmega324P",src:n(5743).A+"",width:"799",height:"643"})}),"\n",(0,r.jsxs)(s.p,{children:["Aujourd\u2019hui, nous nous concentrons sur le ",(0,r.jsx)(s.strong,{children:"mode Fast PWM"}),", un mode courant adapt\xe9 \xe0 des applications g\xe9n\xe9rales comme la variation de luminosit\xe9 de LED ou le contr\xf4le de vitesse d\u2019un moteur."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"fast-pwm",children:"Fast PWM"}),"\n",(0,r.jsxs)(s.p,{children:["En mode ",(0,r.jsx)(s.strong,{children:"Fast PWM"}),", le timer compte uniquement sur le ",(0,r.jsx)(s.strong,{children:"front montant"})," du signal d\u2019horloge. Les changements de cycle de travail (duty cycle) prennent effet imm\xe9diatement, mais le signal n\u2019est pas centr\xe9 \u2014 un d\xe9calage ou un artefact peut appara\xeetre lors de changements brusques du rapport cyclique."]}),"\n",(0,r.jsxs)(s.p,{children:["Plusieurs variantes du mode Fast PWM sont disponibles selon les timers. Pour ",(0,r.jsx)(s.strong,{children:"Timer1"}),", on trouve :"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Fast PWM 8 bits : TOP = 0x00FF"}),"\n",(0,r.jsx)(s.li,{children:"Fast PWM 9 bits : TOP = 0x01FF"}),"\n",(0,r.jsx)(s.li,{children:"Fast PWM 10 bits : TOP = 0x03FF"}),"\n",(0,r.jsxs)(s.li,{children:["Fast PWM avec TOP dans ",(0,r.jsx)(s.code,{children:"ICR"})]}),"\n",(0,r.jsxs)(s.li,{children:["Fast PWM avec TOP dans ",(0,r.jsx)(s.code,{children:"OCRnA"})]}),"\n"]}),"\n",(0,r.jsx)(s.admonition,{title:"\ud83d\udca1",type:"note",children:(0,r.jsxs)(s.p,{children:["Dans ce TP, nous utiliserons uniquement le ",(0,r.jsx)(s.strong,{children:"mode Fast PWM 8 bits"}),". Reportez-vous \xe0 la fiche technique pour d\xe9couvrir les autres modes sp\xe9cifiques aux timers."]})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsxs)(s.p,{children:["Supposons que le Timer1 soit configur\xe9 en ",(0,r.jsx)(s.strong,{children:"Fast PWM"}),". Ce mode poss\xe8de une fr\xe9quence fixe et permet de modifier le cycle de travail pendant l\u2019ex\xe9cution."]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Avec le mode ",(0,r.jsx)(s.code,{children:"10"})," pour ",(0,r.jsx)(s.code,{children:"COM1A1:COM1A0"}),", le signal sur la broche ",(0,r.jsx)(s.code,{children:"OC1A"})," reste \xe0 l\u2019\xe9tat HAUT pendant la mont\xe9e jusqu\u2019au seuil, puis passe \xe0 l\u2019\xe9tat BAS jusqu\u2019\xe0 la fin du cycle."]}),"\n",(0,r.jsxs)(s.li,{children:["Pour obtenir un cycle de travail de ",(0,r.jsx)(s.code,{children:"x%"}),", on d\xe9finit :",(0,r.jsx)(s.br,{}),"\n",(0,r.jsx)(s.code,{children:"OCR1A = x * TOP / 100"}),(0,r.jsx)(s.br,{}),"\n","o\xf9 ",(0,r.jsx)(s.code,{children:"TOP"})," vaut 255 (8 bits), 511 (9 bits), ou 1023 (10 bits), selon la configuration."]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h4,{id:"exemple--timer1-en-fast-pwm-8-bits-mode-non-invers\xe9-avec-pr\xe9diviseur-de-1024",children:"Exemple : Timer1 en Fast PWM 8 bits, mode non-invers\xe9 avec pr\xe9diviseur de 1024"}),"\n",(0,r.jsxs)(s.p,{children:["Fr\xe9quence PWM \u2248 12 MHz / 1024 / 255 \u2248 ",(0,r.jsx)(s.strong,{children:"45 Hz"})]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-c",children:"/* OC1A est PD5, doit \xeatre configur\xe9e en sortie */\nDDRB |= (1 << PD5);\n\n/* S\xe9lectionner le mode Fast PWM 8 bits : WGM[3:0] = 0b0101 */\n/* WGM10 et WGM11 -> TCCR1A ; WGM12 et WGM13 -> TCCR1B */\nTCCR1A = (1 << WGM10);\nTCCR1B = (1 << WGM12);\n\n/* Mode non-invers\xe9 sur OC1A : COM1A[1:0] = 0b10 */\nTCCR1A |= (1 << COM1A1);\n\n/* D\xe9finir le pr\xe9diviseur \xe0 1024 : CS1[2:0] = 0b101 */\nTCCR1B |= (1 << CS12) | (1 << CS10);\n\n/* D\xe9finir un cycle de travail \xe0 50% (TOP = 255, donc OCR1A = 127) */\nOCR1A = 127;\n"})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"phase-correct-pwm",children:"Phase Correct PWM"}),"\n",(0,r.jsxs)(s.p,{children:["Bien que nous n'utilisions pas ce mode dans le TP, il est utile de comprendre comment ",(0,r.jsx)(s.strong,{children:"Phase Correct PWM"})," diff\xe8re du Fast PWM \u2014 il offre une meilleure pr\xe9cision, souvent requise pour les ",(0,r.jsx)(s.strong,{children:"moteurs BLDC ou l\u2019audio"}),"."]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Diff\xe9rence cl\xe9"})," : le compteur compte de BOTTOM jusqu\u2019\xe0 TOP, puis redescend jusqu\u2019\xe0 BOTTOM."]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["La sortie est d\xe9finie par comparaison avec ",(0,r.jsx)(s.code,{children:"OCRnx"}),", comme en Fast PWM."]}),"\n",(0,r.jsxs)(s.li,{children:["Cependant, ",(0,r.jsx)(s.code,{children:"OCRnx"})," reste constant pendant tout le cycle, ce qui donne une dur\xe9e ON plus stable et un signal ",(0,r.jsx)(s.strong,{children:"plus propre"}),"."]}),"\n",(0,r.jsx)(s.li,{children:"Cela \xe9vite les variations de fr\xe9quence (jitter) \u2014 crucial pour les moteurs, qui peuvent perdre en efficacit\xe9 avec une PWM irr\xe9guli\xe8re."}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"Chronogramme Phase Correct PWM",src:n(2942).A+"",width:"943",height:"520"})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"comparaison--fast-pwm-vs-phase-correct-pwm",children:"Comparaison : Fast PWM vs Phase Correct PWM"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"Fast PWM (gauche) vs Phase Correct PWM (droite)",src:n(9646).A+"",width:"2074",height:"1000"})}),"\n",(0,r.jsx)(s.h2,{id:"3-exercices",children:"3. Exercices"}),"\n",(0,r.jsxs)(s.p,{children:["L\u2019objectif de ces exercices est de contr\xf4ler la couleur d\u2019une LED RGB \xe0 l\u2019aide de la PWM. En ajustant ind\xe9pendamment la luminosit\xe9 de chaque diode (Rouge, Vert, Bleu), vous pouvez g\xe9n\xe9rer ",(0,r.jsx)(s.strong,{children:"n\u2019importe quelle couleur"})," !"]}),"\n",(0,r.jsx)(s.p,{children:"Les broches de la LED RGB sont connect\xe9es comme suit :"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Rouge"})," : broche ",(0,r.jsx)(s.code,{children:"PD5"}),", fonction ",(0,r.jsx)(s.code,{children:"OC1A"})," (li\xe9e au Timer1)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Vert"})," : broche ",(0,r.jsx)(s.code,{children:"PD7"}),", fonction ",(0,r.jsx)(s.code,{children:"OC2A"})," (li\xe9e au Timer2)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Bleu"})," : broche ",(0,r.jsx)(s.code,{children:"PB3"}),", fonction ",(0,r.jsx)(s.code,{children:"OC0A"})," (li\xe9e au Timer0)"]}),"\n"]}),"\n",(0,r.jsx)(s.admonition,{title:"Rappel",type:"info",children:(0,r.jsxs)(s.p,{children:["La LED RGB est c\xe2bl\xe9e avec une ",(0,r.jsx)(s.strong,{children:"anode commune"}),' / configuration "active-bas" \u2014 la LED s\u2019allume lorsque la broche est \xe0 l\u2019\xe9tat BAS (LOW), et s\u2019\xe9teint lorsqu\u2019elle est \xe0 l\u2019\xe9tat HAUT (HIGH).']})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"t\xe2che-0",children:"T\xe2che 0"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["T\xe9l\xe9chargez et ex\xe9cutez le ",(0,r.jsx)(s.a,{href:"https://ocw.cs.pub.ro/courses/_media/pm/lab/lab3-2023-2024/lab3-skel-2023-2024.zip",children:"projet de d\xe9part (ZIP)"}),".","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Que remarquez-vous sur la carte ?"}),"\n",(0,r.jsx)(s.li,{children:"Consultez le moniteur s\xe9rie \u2014 vous souvenez-vous comment la temporisation \xe9tait g\xe9r\xe9e dans le TP pr\xe9c\xe9dent ?"}),"\n",(0,r.jsx)(s.li,{children:"Comment se comporte la LED ? Quel timer est utilis\xe9 et dans quel mode ?"}),"\n",(0,r.jsx)(s.li,{children:"O\xf9 l\u2019intensit\xe9 est-elle mise \xe0 jour ? Quelle est l\u2019entr\xe9e de la formule, et o\xf9 est appliqu\xe9e la sortie ?"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"t\xe2che-1",children:"T\xe2che 1"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["Faisons en sorte que la LED ",(0,r.jsx)(s.strong,{children:"bleue"})," se comporte de la m\xeame mani\xe8re.","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Utilisez le Timer0 (",(0,r.jsx)(s.code,{children:"OC0A"})," sur ",(0,r.jsx)(s.code,{children:"PB3"}),") en ",(0,r.jsx)(s.strong,{children:"mode Fast PWM"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Consultez la ",(0,r.jsx)(s.strong,{children:"Section 12.9"})," du ",(0,r.jsx)(s.a,{href:"https://ww1.microchip.com/downloads/en/DeviceDoc/Atmel-42743-ATmega324P_Datasheet.pdf",children:"Datasheet ATmega324P"})," pour une bonne utilisation des registres \u2014 les registres du Timer0 sont diff\xe9rents de ceux du Timer1 !"]}),"\n",(0,r.jsxs)(s.li,{children:["Faites pulser la LED bleue ",(0,r.jsx)(s.strong,{children:"plus rapidement"})," que la rouge, et en ",(0,r.jsx)(s.strong,{children:"parall\xe8le"}),"."]}),"\n",(0,r.jsx)(s.li,{children:"Que remarquez-vous ?"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"t\xe2che-2",children:"T\xe2che 2"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["C\u2019est au tour de la LED ",(0,r.jsx)(s.strong,{children:"verte"})," !","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Probl\xe8me : ",(0,r.jsx)(s.code,{children:"PD7"})," (OC2A) est utilis\xe9 par le Timer2, d\xe9j\xe0 utilis\xe9 pour les ticks syst\xe8me de ",(0,r.jsx)(s.code,{children:"millis()"}),"..."]}),"\n",(0,r.jsxs)(s.li,{children:["Solution : nous allons g\xe9n\xe9rer la PWM manuellement en utilisant les ",(0,r.jsx)(s.strong,{children:"interruptions"})," :","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Le Timer2 compte de 0 \xe0 188 et d\xe9clenche une interruption via ",(0,r.jsx)(s.code,{children:"COMPA"})," (pour incr\xe9menter ",(0,r.jsx)(s.code,{children:"systicks"}),")."]}),"\n",(0,r.jsxs)(s.li,{children:["Le deuxi\xe8me comparateur ",(0,r.jsx)(s.code,{children:"COMPB"})," du Timer2 d\xe9clenche une interruption \xe0 une valeur entre 0\u2013188."]}),"\n",(0,r.jsxs)(s.li,{children:["Dans l\u2019ISR de ",(0,r.jsx)(s.code,{children:"COMPA"})," : allumer la LED verte \u2192 mettre le GPIO \xe0 LOW."]}),"\n",(0,r.jsxs)(s.li,{children:["Dans l\u2019ISR de ",(0,r.jsx)(s.code,{children:"COMPB"})," : \xe9teindre la LED verte \u2192 mettre le GPIO \xe0 HIGH."]}),"\n",(0,r.jsxs)(s.li,{children:["Le cycle de travail est d\xe9fini par ",(0,r.jsx)(s.code,{children:"OCR2B"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.admonition,{type:"warning",children:(0,r.jsxs)(s.p,{children:["Gardez ",(0,r.jsx)(s.code,{children:"OCR2A = 188"})," pour conserver le bon fonctionnement de ",(0,r.jsx)(s.code,{children:"millis()"}),"."]})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"t\xe2che-3",children:"T\xe2che 3"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["Parcourez toutes les couleurs \xe0 l\u2019aide de l\u2019espace colorim\xe9trique ",(0,r.jsx)(s.strong,{children:"HSV"})," :","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Convertissez HSV \u2192 RGB en utilisant la fonction ",(0,r.jsx)(s.code,{children:"convert_HSV_to_RGB()"})," fournie."]}),"\n",(0,r.jsxs)(s.li,{children:["Faites varier la ",(0,r.jsx)(s.strong,{children:"Teinte (Hue)"})," dans le temps, gardez ",(0,r.jsx)(s.strong,{children:"Saturation = 1"}),", ",(0,r.jsx)(s.strong,{children:"Valeur = 1"})," (luminosit\xe9 maximale)."]}),"\n",(0,r.jsx)(s.li,{children:"Utilisez les ticks syst\xe8me pour animer la couleur de mani\xe8re fluide, comme pour la pulsation des LEDs."}),"\n",(0,r.jsx)(s.li,{children:"Assurez-vous de d\xe9sactiver tout code en conflit qui modifierait l\u2019intensit\xe9 des LEDs."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"Roue des Couleurs HSV",src:n(669).A+"",width:"650",height:"555"})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"t\xe2che-4-bonus",children:"T\xe2che 4 (Bonus)"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["Utilisez le ",(0,r.jsx)(s.strong,{children:"haut-parleur"})," connect\xe9 \xe0 ",(0,r.jsx)(s.code,{children:"PD4"})," (\xe9galement ",(0,r.jsx)(s.code,{children:"OC1B"}),") pour ",(0,r.jsx)(s.strong,{children:"jouer une m\xe9lodie"})," depuis le module ",(0,r.jsx)(s.code,{children:"sound.c"}),".","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"surprise_notes[]"})," contient les fr\xe9quences."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"durations[]"})," contient les dur\xe9es des notes."]}),"\n",(0,r.jsxs)(s.li,{children:["Dans ",(0,r.jsx)(s.code,{children:"update_notes()"}),", reconfigurez le Timer1 \xe0 chaque nouvelle note :","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Utilisez le ",(0,r.jsx)(s.strong,{children:"mode CTC"})," (",(0,r.jsx)(s.code,{children:"OCR1A"})," d\xe9finit la valeur TOP \u2192 contr\xf4le la fr\xe9quence)."]}),"\n",(0,r.jsxs)(s.li,{children:["R\xe9glez ",(0,r.jsx)(s.code,{children:"OCR1B = OCR1A / 2"})," pour un cycle de travail de 50% (onde carr\xe9e)."]}),"\n",(0,r.jsxs)(s.li,{children:["Appelez ",(0,r.jsx)(s.code,{children:"update_notes()"})," toutes les ",(0,r.jsx)(s.strong,{children:"25 ms"})," via ",(0,r.jsx)(s.code,{children:"systicks"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Remettez ",(0,r.jsx)(s.code,{children:"TCNT1 = 0"})," apr\xe8s chaque modification de ",(0,r.jsx)(s.code,{children:"OCR1A"})," pour \xe9viter les d\xe9calages temporels."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"bonus-2",children:"Bonus 2"}),"\n",(0,r.jsx)(s.p,{children:"Combinez :"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["L\u2019animation RGB (cycle HSV) ",(0,r.jsx)(s.strong,{children:"et"})," (and)"]}),"\n",(0,r.jsx)(s.li,{children:"La lecture de la m\xe9lodie (via le haut-parleur)"}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["\u2014 les deux fonctionnant ",(0,r.jsx)(s.strong,{children:"simultan\xe9ment"})," et de mani\xe8re fluide."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"4-liens-utiles",children:"4. Liens Utiles"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["[1] ",(0,r.jsx)(s.a,{href:"http://www.afrotechmods.com/groovy/PWM_tutorial/PWM_tutorial.htm",children:"Tutoriel Vid\xe9o sur la PWM"})]}),"\n",(0,r.jsxs)(s.li,{children:["[2] ",(0,r.jsx)(s.a,{href:"http://www.avrfreaks.net/index.php?name=PNphpBB2&file=printview&t=68302",children:"Guide PWM sur AVR Freaks"})]}),"\n",(0,r.jsxs)(s.li,{children:["[3] ",(0,r.jsx)(s.a,{href:"https://docs.arduino.cc/tutorials/generic/secrets-of-arduino-pwm",children:"Secrets de la PWM sur Arduino"})]}),"\n",(0,r.jsxs)(s.li,{children:["[4] ",(0,r.jsx)(s.a,{href:"https://ww1.microchip.com/downloads/en/DeviceDoc/Atmel-42743-ATmega324P_Datasheet.pdf",children:"Datasheet ATmega324P"})]}),"\n"]})]})}function m(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},5743:(e,s,n)=>{n.d(s,{A:()=>l});const l=n.p+"assets/images/atmega324_pwm_pins-dd3744f2406886328e68cc7fe0b62027.png"},7003:(e,s,n)=>{n.d(s,{A:()=>i});n(6540);var l=n(8069),r=n(4848);const i=e=>{let{code:s,language:n="javascript",inline:i=!1}=e;return i?(0,r.jsx)("code",{style:{backgroundColor:"#f5f5f5",padding:"2px 4px",borderRadius:"4px"},children:s}):(0,r.jsx)(l.A,{language:n,children:s})}},7272:(e,s,n)=>{n.d(s,{So:()=>c,aW:()=>t,g5:()=>r,gq:()=>l,l3:()=>i,yN:()=>a});n(4848);const l="\nvoid USART0_init(unsigned int baud_rate)\n{\n  /* Set baud rate */\n  UBRR0H = (unsigned char)(baud_rate >> 8);\n  UBRR0L = (unsigned char)baud_rate;\n\n  /* Enable transmitter and receiver */\n  UCSR0B = (1 << TXEN0) | (1 << RXEN0);\n\n  /* Set frame format: 8 data bits, 2 stop bits, no parity */\n  UCSR0C = (1 << USBS0) | (3 << UCSZ00);\n}\n\nvoid USART0_transmit(unsigned char data) {\n    /* Wait until the buffer is empty */\n    while (!(UCSR0A & (1 << UDRE0)));\n\n    /* Load data into the buffer; transmission starts automatically */\n    UDR0 = data;\n}\n\nchar USART0_receive()\n{\n  /* Wait while the buffer is empty */\n  while (!(UCSR0A & (1 << RXC0)));\n\n  /* Return data from buffer */\n  return UDR0;\n}\n",r="\nboard_build.f_cpu = 12000000L\n",i="\nmonitor_speed = 28800\n",a="\nmonitor_echo = true\n",t="\nvoid USART_exec(unsigned char command);\n",c='\nif (strcmp(received_command, "pedestrian") == 0) {\n    // Handle traffic light sequence\n} else {\n    USART0_transmit("incorrect command");\n}\n'},7969:(e,s,n)=>{n.d(s,{A:()=>l});const l=n.p+"assets/images/avr_pwm_01-3245bf91318e95f2f01586ece2f266bd.jpg"},8325:(e,s,n)=>{n.d(s,{A:()=>l});const l=n.p+"assets/images/main-qimg-72a9c6569290abe0a85dceabaf8c7ff9-bce705736a7ef84c46ac6f32d18efb5c.gif"},9329:(e,s,n)=>{n.d(s,{A:()=>a});n(6540);var l=n(4164);const r={tabItem:"tabItem_Ymn6"};var i=n(4848);function a(e){let{children:s,hidden:n,className:a}=e;return(0,i.jsx)("div",{role:"tabpanel",className:(0,l.A)(r.tabItem,a),hidden:n,children:s})}},9646:(e,s,n)=>{n.d(s,{A:()=>l});const l=n.p+"assets/images/merged_pwm_waveforms-72cf59564a76502f5e36cd7e61eb619c.png"}}]);