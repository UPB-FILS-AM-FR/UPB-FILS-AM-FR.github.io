<!doctype html>
<html lang="fr" dir="ltr" class="docs-wrapper plugin-docs plugin-id-lab docs-version-current docs-doc-page docs-doc-id-lab03/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">TP 3 : Timers, Modulation de Largeur d&#x27;Impulsion (PWM) | Microprocessor Architecture</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://upb-fils-am-fr.github.io/fr/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://upb-fils-am-fr.github.io/fr/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://upb-fils-am-fr.github.io/fr/lab/lab03"><meta data-rh="true" property="og:locale" content="fr"><meta data-rh="true" property="og:locale:alternate" content="en_GB"><meta data-rh="true" name="docusaurus_locale" content="fr"><meta data-rh="true" name="docsearch:language" content="fr"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-lab-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-lab-current"><meta data-rh="true" property="og:title" content="TP 3 : Timers, Modulation de Largeur d&#x27;Impulsion (PWM) | Microprocessor Architecture"><meta data-rh="true" name="description" content="Chapitres utiles du Datasheet ATmega324P"><meta data-rh="true" property="og:description" content="Chapitres utiles du Datasheet ATmega324P"><link data-rh="true" rel="icon" href="/fr/img/sigla_am.ico"><link data-rh="true" rel="canonical" href="https://upb-fils-am-fr.github.io/fr/lab/lab03"><link data-rh="true" rel="alternate" href="https://upb-fils-am-fr.github.io/lab/lab03" hreflang="en-GB"><link data-rh="true" rel="alternate" href="https://upb-fils-am-fr.github.io/fr/lab/lab03" hreflang="fr"><link data-rh="true" rel="alternate" href="https://upb-fils-am-fr.github.io/lab/lab03" hreflang="x-default"><link rel="stylesheet" href="/fr/assets/css/styles.f442cfaf.css">
<script src="/fr/assets/js/runtime~main.7a0b284e.js" defer="defer"></script>
<script src="/fr/assets/js/main.65f92606.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/fr/img/sigla_am.svg"><div role="region" aria-label="Aller au contenu principal"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Aller au contenu principal</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Ouvrir/fermer la barre de navigation" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/fr/"><div class="navbar__logo"><img src="/fr/img/sigla_am.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/fr/img/sigla_am.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Microprocessor Architecture</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/fr/lab">Lab</a><a class="navbar__item navbar__link" href="/fr/project">Project</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>Français</a><ul class="dropdown__menu"><li><a href="/lab/lab03" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en-GB">English</a></li><li><a href="/fr/lab/lab03" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="fr">Français</a></li></ul></div><a href="https://github.com/UPB-FILS-AM-FR/am-website" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Basculer entre le mode sombre et clair (actuellement mode clair)" aria-label="Basculer entre le mode sombre et clair (actuellement mode clair)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Retour au début de la page" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/fr/lab">Info General Labo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/fr/lab/lab00">Laboratoire 0 : ATmega324. GPIO</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/fr/lab/lab01">Laboratoire 1 : USART. Débogage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/fr/lab/lab02">Laboratoire 2 : Interruptions, Timers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/fr/lab/lab03">TP 3 : Timers, Modulation de Largeur d&#x27;Impulsion (PWM)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/fr/lab/lab04">Lab 4: Analog to Digital Converter (ADC)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/fr/lab/lab05">Lab 5: SPI (Serial Peripheral Interface)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/fr/lab/lab06">Lab 6: I2C (Inter-Integrated Circuit)</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Fil d&#x27;Ariane"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Page d&#x27;accueil" class="breadcrumbs__link" href="/fr/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">TP 3 : Timers, Modulation de Largeur d&#x27;Impulsion (PWM)</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">Sur cette page</button></div><div class="theme-doc-markdown markdown"><header><h1>TP 3 : Timers, Modulation de Largeur d&#x27;Impulsion (PWM)</h1></header>
<p><strong>Chapitres utiles du <a href="https://ww1.microchip.com/downloads/en/DeviceDoc/Atmel-42743-ATmega324P_Datasheet.pdf" target="_blank" rel="noopener noreferrer">Datasheet ATmega324P</a></strong></p>
<ul>
<li>
<ol>
<li>Configuration des broches – section 1.1, page 15</li>
</ol>
</li>
<li>
<ol start="16">
<li>Timer/Compteur 8 bits 0 avec PWM – section 16.9, page 140</li>
</ol>
</li>
<li>
<ol start="17">
<li>Timer/Compteur 16 bits 1 avec PWM – section 17.14, page 173</li>
</ol>
</li>
<li>
<ol start="19">
<li>Timer/Compteur 8 bits 2 avec PWM et fonctionnement asynchrone – section 19.11, page 202</li>
</ol>
</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-modulation-de-largeur-dimpulsion-pwm">1. Modulation de Largeur d&#x27;Impulsion (PWM)<a href="#1-modulation-de-largeur-dimpulsion-pwm" class="hash-link" aria-label="Lien direct vers 1. Modulation de Largeur d&#x27;Impulsion (PWM)" title="Lien direct vers 1. Modulation de Largeur d&#x27;Impulsion (PWM)">​</a></h2>
<p>La <strong>PWM</strong> (Pulse Width Modulation) est une technique permettant de contrôler la tension appliquée à un dispositif électronique en le commutant rapidement entre les états <strong>ON</strong> et <strong>OFF</strong>.</p>
<p>Ce basculement rapide génère une <strong>tension moyenne</strong> déterminée par le temps pendant lequel le signal reste à l&#x27;état ON par rapport au temps total du cycle — ce rapport s&#x27;appelle le <strong>cycle de travail</strong> (<em>duty cycle</em>).</p>
<p><img decoding="async" loading="lazy" alt="Principe PWM" src="/fr/assets/images/main-qimg-72a9c6569290abe0a85dceabaf8c7ff9-bce705736a7ef84c46ac6f32d18efb5c.gif" width="561" height="210" class="img_ev3q"></p>
<p>La PWM permet un <strong>contrôle numérique</strong> de <strong>signaux analogiques</strong>, par exemple :</p>
<ul>
<li>Variation de l&#x27;intensité d&#x27;une LED</li>
<li>Changement de couleur des LEDs RGB</li>
<li>Réglage de la fréquence d’un buzzer</li>
<li>Contrôle de la vitesse d’un moteur</li>
</ul>
<p><img decoding="async" loading="lazy" alt="Contrôle LED par PWM" src="/fr/assets/images/pwm_led-99e7e25dfc8515e2e21b4990787538d0.gif" width="1200" height="600" class="img_ev3q"></p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-principe-de-fonctionnement">1.1. Principe de fonctionnement<a href="#11-principe-de-fonctionnement" class="hash-link" aria-label="Lien direct vers 1.1. Principe de fonctionnement" title="Lien direct vers 1.1. Principe de fonctionnement">​</a></h3>
<p>Le cycle de travail s’exprime en pourcentage du temps ON par rapport au cycle total :</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>D</mi><mo stretchy="false">[</mo><mi mathvariant="normal">%</mi><mo stretchy="false">]</mo><mo>=</mo><mfrac><msub><mi>t</mi><mrow><mi>o</mi><mi>n</mi></mrow></msub><mrow><msub><mi>t</mi><mrow><mi>o</mi><mi>n</mi></mrow></msub><mo>+</mo><msub><mi>t</mi><mrow><mi>o</mi><mi>f</mi><mi>f</mi></mrow></msub></mrow></mfrac><mo>⋅</mo><mn>100</mn><mo>=</mo><mfrac><mrow><mi>p</mi><mi>u</mi><mi>l</mi><mi>s</mi><mi>e</mi><mi mathvariant="normal">_</mi><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi></mrow><mrow><mi>p</mi><mi>e</mi><mi>r</mi><mi>i</mi><mi>o</mi><mi>d</mi></mrow></mfrac><mo>⋅</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">D[\%] = \frac{t_{on}}{t_{on} + t_{off}} \cdot 100 = \frac{pulse\_width}{period} \cdot 100</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="mopen">[</span><span class="mord">%</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.2642em;vertical-align:-0.9721em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2921em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.10764em">ff</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9721em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">100</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.2749em;vertical-align:-0.8804em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3944em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.02778em">er</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.7em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style="margin-right:0.01968em">l</span><span class="mord mathnormal">se</span><span class="mord" style="margin-right:0.02778em">_</span><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="mord mathnormal">i</span><span class="mord mathnormal">d</span><span class="mord mathnormal">t</span><span class="mord mathnormal">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">100</span></span></span></span></span>
<p>La <strong>tension moyenne</strong> reçue par un dispositif est :</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mover accent="true"><mi>V</mi><mo>ˉ</mo></mover><mo>=</mo><mi>D</mi><mo>⋅</mo><msub><mi>V</mi><mrow><mi>c</mi><mi>c</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\bar{V} = D \cdot V_{cc}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201em"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span style="top:-3.2523em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.25em"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">cc</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>
<p><img decoding="async" loading="lazy" alt="Signaux PWM avec différents cycles de travail" src="/fr/assets/images/avr_pwm_01-3245bf91318e95f2f01586ece2f266bd.jpg" width="987" height="237" class="img_ev3q"></p>
<p>Les signaux PWM sont généralement générés par des circuits numériques et des microcontrôleurs. L’ATmega324 utilise un <strong>compteur</strong> qui se réinitialise périodiquement et compare sa valeur avec une référence (<code>OCRn</code>). Lorsque le compteur dépasse la valeur de référence, la sortie PWM change d’état.</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>🛠️ PWM par logiciel ?</summary><div><div class="collapsibleContent_i85q"><p>La PWM peut également être implémentée en logiciel avec des méthodes comme :</p><ul>
<li>Bit-banging</li>
<li>Timers avec routines d’interruption (ISR)</li>
</ul><p>Mais pour une PWM à <strong>haute fréquence</strong> (par exemple, dans les kHz pour les moteurs), la <strong>PWM matérielle</strong> est bien plus efficace, car elle évite la surcharge du CPU causée par des interruptions fréquentes.</p></div></div></details>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-pwm-sur-les-microcontrôleurs-avr">2. PWM sur les Microcontrôleurs AVR<a href="#2-pwm-sur-les-microcontrôleurs-avr" class="hash-link" aria-label="Lien direct vers 2. PWM sur les Microcontrôleurs AVR" title="Lien direct vers 2. PWM sur les Microcontrôleurs AVR">​</a></h2>
<p>Dans le laboratoire précédent, nous avons vu que l’ATmega324 possède trois timers :</p>
<ul>
<li><code>Timer0</code> (8 bits)</li>
<li><code>Timer1</code> (16 bits)</li>
<li><code>Timer2</code> (8 bits)</li>
</ul>
<p>Chaque timer peut être configuré via les registres de contrôle <code>TCCRnA</code> et <code>TCCRnB</code>, en utilisant les bits <code>WGMnx</code> pour sélectionner le mode :</p>
<ul>
<li><strong>Normal</strong></li>
<li><strong>CTC (Clear Timer on Compare Match)</strong></li>
<li><strong>Fast PWM</strong> (utilisé aujourd’hui !)</li>
<li><strong>Phase Correct PWM</strong>, etc.</li>
</ul>
<p>Chaque timer dispose de deux canaux de comparaison de sortie : <code>OCnA</code> et <code>OCnB</code>. Ceux-ci sont liés à des broches physiques spécifiques. Consultez le chapitre <strong>Pin Configurations</strong> de la fiche technique pour les correspondances exactes :</p>
<p><img decoding="async" loading="lazy" alt="Broches de sortie PWM sur ATmega324P" src="/fr/assets/images/atmega324_pwm_pins-dd3744f2406886328e68cc7fe0b62027.png" width="799" height="643" class="img_ev3q"></p>
<p>Aujourd’hui, nous nous concentrons sur le <strong>mode Fast PWM</strong>, un mode courant adapté à des applications générales comme la variation de luminosité de LED ou le contrôle de vitesse d’un moteur.</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="fast-pwm">Fast PWM<a href="#fast-pwm" class="hash-link" aria-label="Lien direct vers Fast PWM" title="Lien direct vers Fast PWM">​</a></h3>
<p>En mode <strong>Fast PWM</strong>, le timer compte uniquement sur le <strong>front montant</strong> du signal d’horloge. Les changements de cycle de travail (duty cycle) prennent effet immédiatement, mais le signal n’est pas centré — un décalage ou un artefact peut apparaître lors de changements brusques du rapport cyclique.</p>
<p>Plusieurs variantes du mode Fast PWM sont disponibles selon les timers. Pour <strong>Timer1</strong>, on trouve :</p>
<ul>
<li>Fast PWM 8 bits : TOP = 0x00FF</li>
<li>Fast PWM 9 bits : TOP = 0x01FF</li>
<li>Fast PWM 10 bits : TOP = 0x03FF</li>
<li>Fast PWM avec TOP dans <code>ICR</code></li>
<li>Fast PWM avec TOP dans <code>OCRnA</code></li>
</ul>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>💡</div><div class="admonitionContent_BuS1"><p>Dans ce TP, nous utiliserons uniquement le <strong>mode Fast PWM 8 bits</strong>. Reportez-vous à la fiche technique pour découvrir les autres modes spécifiques aux timers.</p></div></div>
<hr>
<p>Supposons que le Timer1 soit configuré en <strong>Fast PWM</strong>. Ce mode possède une fréquence fixe et permet de modifier le cycle de travail pendant l’exécution.</p>
<ul>
<li>Avec le mode <code>10</code> pour <code>COM1A1:COM1A0</code>, le signal sur la broche <code>OC1A</code> reste à l’état HAUT pendant la montée jusqu’au seuil, puis passe à l’état BAS jusqu’à la fin du cycle.</li>
<li>Pour obtenir un cycle de travail de <code>x%</code>, on définit :<br>
<code>OCR1A = x * TOP / 100</code><br>
<!-- -->où <code>TOP</code> vaut 255 (8 bits), 511 (9 bits), ou 1023 (10 bits), selon la configuration.</li>
</ul>
<hr>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple--timer1-en-fast-pwm-8-bits-mode-non-inversé-avec-prédiviseur-de-1024">Exemple : Timer1 en Fast PWM 8 bits, mode non-inversé avec prédiviseur de 1024<a href="#exemple--timer1-en-fast-pwm-8-bits-mode-non-inversé-avec-prédiviseur-de-1024" class="hash-link" aria-label="Lien direct vers Exemple : Timer1 en Fast PWM 8 bits, mode non-inversé avec prédiviseur de 1024" title="Lien direct vers Exemple : Timer1 en Fast PWM 8 bits, mode non-inversé avec prédiviseur de 1024">​</a></h4>
<p>Fréquence PWM ≈ 12 MHz / 1024 / 255 ≈ <strong>45 Hz</strong></p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/* OC1A est PD5, doit être configurée en sortie */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DDRB </span><span class="token operator" style="color:#393A34">|=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> PD5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">/* Sélectionner le mode Fast PWM 8 bits : WGM[3:0] = 0b0101 */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">/* WGM10 et WGM11 -&gt; TCCR1A ; WGM12 et WGM13 -&gt; TCCR1B */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TCCR1A </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> WGM10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TCCR1B </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> WGM12</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">/* Mode non-inversé sur OC1A : COM1A[1:0] = 0b10 */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TCCR1A </span><span class="token operator" style="color:#393A34">|=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> COM1A1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">/* Définir le prédiviseur à 1024 : CS1[2:0] = 0b101 */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TCCR1B </span><span class="token operator" style="color:#393A34">|=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> CS12</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> CS10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">/* Définir un cycle de travail à 50% (TOP = 255, donc OCR1A = 127) */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OCR1A </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">127</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="phase-correct-pwm">Phase Correct PWM<a href="#phase-correct-pwm" class="hash-link" aria-label="Lien direct vers Phase Correct PWM" title="Lien direct vers Phase Correct PWM">​</a></h3>
<p>Bien que nous n&#x27;utilisions pas ce mode dans le TP, il est utile de comprendre comment <strong>Phase Correct PWM</strong> diffère du Fast PWM — il offre une meilleure précision, souvent requise pour les <strong>moteurs BLDC ou l’audio</strong>.</p>
<p><strong>Différence clé</strong> : le compteur compte de BOTTOM jusqu’à TOP, puis redescend jusqu’à BOTTOM.</p>
<ul>
<li>La sortie est définie par comparaison avec <code>OCRnx</code>, comme en Fast PWM.</li>
<li>Cependant, <code>OCRnx</code> reste constant pendant tout le cycle, ce qui donne une durée ON plus stable et un signal <strong>plus propre</strong>.</li>
<li>Cela évite les variations de fréquence (jitter) — crucial pour les moteurs, qui peuvent perdre en efficacité avec une PWM irrégulière.</li>
</ul>
<p><img decoding="async" loading="lazy" alt="Chronogramme Phase Correct PWM" src="/fr/assets/images/phase_correct_pwm-0813510f0ec626ea0e4a3968225159b6.png" width="943" height="520" class="img_ev3q"></p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="comparaison--fast-pwm-vs-phase-correct-pwm">Comparaison : Fast PWM vs Phase Correct PWM<a href="#comparaison--fast-pwm-vs-phase-correct-pwm" class="hash-link" aria-label="Lien direct vers Comparaison : Fast PWM vs Phase Correct PWM" title="Lien direct vers Comparaison : Fast PWM vs Phase Correct PWM">​</a></h3>
<p><img decoding="async" loading="lazy" alt="Fast PWM (gauche) vs Phase Correct PWM (droite)" src="/fr/assets/images/merged_pwm_waveforms-72cf59564a76502f5e36cd7e61eb619c.png" width="2074" height="1000" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-exercices">3. Exercices<a href="#3-exercices" class="hash-link" aria-label="Lien direct vers 3. Exercices" title="Lien direct vers 3. Exercices">​</a></h2>
<p>L’objectif de ces exercices est de contrôler la couleur d’une LED RGB à l’aide de la PWM. En ajustant indépendamment la luminosité de chaque diode (Rouge, Vert, Bleu), vous pouvez générer <strong>n’importe quelle couleur</strong> !</p>
<p>Les broches de la LED RGB sont connectées comme suit :</p>
<ul>
<li><strong>Rouge</strong> : broche <code>PD5</code>, fonction <code>OC1A</code> (liée au Timer1)</li>
<li><strong>Vert</strong> : broche <code>PD7</code>, fonction <code>OC2A</code> (liée au Timer2)</li>
<li><strong>Bleu</strong> : broche <code>PB3</code>, fonction <code>OC0A</code> (liée au Timer0)</li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Rappel</div><div class="admonitionContent_BuS1"><p>La LED RGB est câblée avec une <strong>anode commune</strong> / configuration &quot;active-bas&quot; — la LED s’allume lorsque la broche est à l’état BAS (LOW), et s’éteint lorsqu’elle est à l’état HAUT (HIGH).</p></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="tâche-0">Tâche 0<a href="#tâche-0" class="hash-link" aria-label="Lien direct vers Tâche 0" title="Lien direct vers Tâche 0">​</a></h3>
<ol>
<li>Téléchargez et exécutez le <a href="https://ocw.cs.pub.ro/courses/_media/pm/lab/lab3-2023-2024/lab3-skel-2023-2024.zip" target="_blank" rel="noopener noreferrer">projet de départ (ZIP)</a>.<!-- -->
<ul>
<li>Que remarquez-vous sur la carte ?</li>
<li>Consultez le moniteur série — vous souvenez-vous comment la temporisation était gérée dans le TP précédent ?</li>
<li>Comment se comporte la LED ? Quel timer est utilisé et dans quel mode ?</li>
<li>Où l’intensité est-elle mise à jour ? Quelle est l’entrée de la formule, et où est appliquée la sortie ?</li>
</ul>
</li>
</ol>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="tâche-1">Tâche 1<a href="#tâche-1" class="hash-link" aria-label="Lien direct vers Tâche 1" title="Lien direct vers Tâche 1">​</a></h3>
<ol>
<li>Faisons en sorte que la LED <strong>bleue</strong> se comporte de la même manière.<!-- -->
<ul>
<li>Utilisez le Timer0 (<code>OC0A</code> sur <code>PB3</code>) en <strong>mode Fast PWM</strong>.</li>
<li>Consultez la <strong>Section 12.9</strong> du <a href="https://ww1.microchip.com/downloads/en/DeviceDoc/Atmel-42743-ATmega324P_Datasheet.pdf" target="_blank" rel="noopener noreferrer">Datasheet ATmega324P</a> pour une bonne utilisation des registres — les registres du Timer0 sont différents de ceux du Timer1 !</li>
<li>Faites pulser la LED bleue <strong>plus rapidement</strong> que la rouge, et en <strong>parallèle</strong>.</li>
<li>Que remarquez-vous ?</li>
</ul>
</li>
</ol>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="tâche-2">Tâche 2<a href="#tâche-2" class="hash-link" aria-label="Lien direct vers Tâche 2" title="Lien direct vers Tâche 2">​</a></h3>
<ol>
<li>C’est au tour de la LED <strong>verte</strong> !<!-- -->
<ul>
<li>Problème : <code>PD7</code> (OC2A) est utilisé par le Timer2, déjà utilisé pour les ticks système de <code>millis()</code>...</li>
<li>Solution : nous allons générer la PWM manuellement en utilisant les <strong>interruptions</strong> :<!-- -->
<ul>
<li>Le Timer2 compte de 0 à 188 et déclenche une interruption via <code>COMPA</code> (pour incrémenter <code>systicks</code>).</li>
<li>Le deuxième comparateur <code>COMPB</code> du Timer2 déclenche une interruption à une valeur entre 0–188.</li>
<li>Dans l’ISR de <code>COMPA</code> : allumer la LED verte → mettre le GPIO à LOW.</li>
<li>Dans l’ISR de <code>COMPB</code> : éteindre la LED verte → mettre le GPIO à HIGH.</li>
<li>Le cycle de travail est défini par <code>OCR2B</code>.</li>
</ul>
</li>
</ul>
</li>
</ol>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>attention</div><div class="admonitionContent_BuS1"><p>Gardez <code>OCR2A = 188</code> pour conserver le bon fonctionnement de <code>millis()</code>.</p></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="tâche-3">Tâche 3<a href="#tâche-3" class="hash-link" aria-label="Lien direct vers Tâche 3" title="Lien direct vers Tâche 3">​</a></h3>
<ol>
<li>Parcourez toutes les couleurs à l’aide de l’espace colorimétrique <strong>HSV</strong> :<!-- -->
<ul>
<li>Convertissez HSV → RGB en utilisant la fonction <code>convert_HSV_to_RGB()</code> fournie.</li>
<li>Faites varier la <strong>Teinte (Hue)</strong> dans le temps, gardez <strong>Saturation = 1</strong>, <strong>Valeur = 1</strong> (luminosité maximale).</li>
<li>Utilisez les ticks système pour animer la couleur de manière fluide, comme pour la pulsation des LEDs.</li>
<li>Assurez-vous de désactiver tout code en conflit qui modifierait l’intensité des LEDs.</li>
</ul>
</li>
</ol>
<p><img decoding="async" loading="lazy" alt="Roue des Couleurs HSV" src="/fr/assets/images/hue-wheel-c49e6582240e8af2ccba3fa0b5d56475.png" width="650" height="555" class="img_ev3q"></p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="tâche-4-bonus">Tâche 4 (Bonus)<a href="#tâche-4-bonus" class="hash-link" aria-label="Lien direct vers Tâche 4 (Bonus)" title="Lien direct vers Tâche 4 (Bonus)">​</a></h3>
<ol>
<li>Utilisez le <strong>haut-parleur</strong> connecté à <code>PD4</code> (également <code>OC1B</code>) pour <strong>jouer une mélodie</strong> depuis le module <code>sound.c</code>.<!-- -->
<ul>
<li><code>surprise_notes[]</code> contient les fréquences.</li>
<li><code>durations[]</code> contient les durées des notes.</li>
<li>Dans <code>update_notes()</code>, reconfigurez le Timer1 à chaque nouvelle note :<!-- -->
<ul>
<li>Utilisez le <strong>mode CTC</strong> (<code>OCR1A</code> définit la valeur TOP → contrôle la fréquence).</li>
<li>Réglez <code>OCR1B = OCR1A / 2</code> pour un cycle de travail de 50% (onde carrée).</li>
<li>Appelez <code>update_notes()</code> toutes les <strong>25 ms</strong> via <code>systicks</code>.</li>
<li>Remettez <code>TCNT1 = 0</code> après chaque modification de <code>OCR1A</code> pour éviter les décalages temporels.</li>
</ul>
</li>
</ul>
</li>
</ol>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="bonus-2">Bonus 2<a href="#bonus-2" class="hash-link" aria-label="Lien direct vers Bonus 2" title="Lien direct vers Bonus 2">​</a></h3>
<p>Combinez :</p>
<ul>
<li>L’animation RGB (cycle HSV) <strong>et</strong> (and)</li>
<li>La lecture de la mélodie (via le haut-parleur)</li>
</ul>
<p>— les deux fonctionnant <strong>simultanément</strong> et de manière fluide.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-liens-utiles">4. Liens Utiles<a href="#4-liens-utiles" class="hash-link" aria-label="Lien direct vers 4. Liens Utiles" title="Lien direct vers 4. Liens Utiles">​</a></h2>
<ul>
<li>[1] <a href="http://www.afrotechmods.com/groovy/PWM_tutorial/PWM_tutorial.htm" target="_blank" rel="noopener noreferrer">Tutoriel Vidéo sur la PWM</a></li>
<li>[2] <a href="http://www.avrfreaks.net/index.php?name=PNphpBB2&amp;file=printview&amp;t=68302" target="_blank" rel="noopener noreferrer">Guide PWM sur AVR Freaks</a></li>
<li>[3] <a href="https://docs.arduino.cc/tutorials/generic/secrets-of-arduino-pwm" target="_blank" rel="noopener noreferrer">Secrets de la PWM sur Arduino</a></li>
<li>[4] <a href="https://ww1.microchip.com/downloads/en/DeviceDoc/Atmel-42743-ATmega324P_Datasheet.pdf" target="_blank" rel="noopener noreferrer">Datasheet ATmega324P</a></li>
</ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Pages de documentation"><a class="pagination-nav__link pagination-nav__link--prev" href="/fr/lab/lab02"><div class="pagination-nav__sublabel">Précédent</div><div class="pagination-nav__label">Laboratoire 2 : Interruptions, Timers</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/fr/lab/lab04"><div class="pagination-nav__sublabel">Suivant</div><div class="pagination-nav__label">Lab 4: Analog to Digital Converter (ADC)</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-modulation-de-largeur-dimpulsion-pwm" class="table-of-contents__link toc-highlight">1. Modulation de Largeur d&#39;Impulsion (PWM)</a><ul><li><a href="#11-principe-de-fonctionnement" class="table-of-contents__link toc-highlight">1.1. Principe de fonctionnement</a></li></ul></li><li><a href="#2-pwm-sur-les-microcontrôleurs-avr" class="table-of-contents__link toc-highlight">2. PWM sur les Microcontrôleurs AVR</a><ul><li><a href="#fast-pwm" class="table-of-contents__link toc-highlight">Fast PWM</a></li><li><a href="#phase-correct-pwm" class="table-of-contents__link toc-highlight">Phase Correct PWM</a></li><li><a href="#comparaison--fast-pwm-vs-phase-correct-pwm" class="table-of-contents__link toc-highlight">Comparaison : Fast PWM vs Phase Correct PWM</a></li></ul></li><li><a href="#3-exercices" class="table-of-contents__link toc-highlight">3. Exercices</a><ul><li><a href="#tâche-0" class="table-of-contents__link toc-highlight">Tâche 0</a></li><li><a href="#tâche-1" class="table-of-contents__link toc-highlight">Tâche 1</a></li><li><a href="#tâche-2" class="table-of-contents__link toc-highlight">Tâche 2</a></li><li><a href="#tâche-3" class="table-of-contents__link toc-highlight">Tâche 3</a></li><li><a href="#tâche-4-bonus" class="table-of-contents__link toc-highlight">Tâche 4 (Bonus)</a></li><li><a href="#bonus-2" class="table-of-contents__link toc-highlight">Bonus 2</a></li></ul></li><li><a href="#4-liens-utiles" class="table-of-contents__link toc-highlight">4. Liens Utiles</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://ocw.cs.pub.ro/courses/pm" target="_blank" rel="noopener noreferrer" class="footer__link-item">UPB Open CourseWare <svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Politehnica Bucharest. <br> This pages are the translated and adapted version from https://ocw.cs.pub.ro/courses/pm</div></div></div></footer></div>
</body>
</html>